<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  
  <!-- SEO Meta Tags -->
  <title>Vikas Public School - Excellence in Education | Top School in [Your City]</title>
  <meta name="description" content="Vikas Public School, established in 2006, offers quality education with holistic development. Admissions open for 2025-26. Excellence in academics, sports, and character building." />
  <meta name="keywords" content="Vikas Public School, best school, quality education, admissions 2025, CBSE school, primary education, secondary education, holistic development, experienced faculty" />
  <meta name="author" content="Vikas Public School" />
  <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1" />
  
  <!-- Canonical URL -->
  <link rel="canonical" href="https://vikaspublicschool.edu" />
  
  <!-- Open Graph Meta Tags for Social Media -->
  <meta property="og:title" content="Vikas Public School - Excellence in Education" />
  <meta property="og:description" content="Premier educational institution offering quality education since 2006. Nurturing young minds through holistic development and innovative teaching methods." />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://vikaspublicschool.edu" />
  <meta property="og:image" content="https://vikaspublicschool.edu/assets/logo.png" />
  <meta property="og:image:alt" content="Vikas Public School Logo" />
  <meta property="og:site_name" content="Vikas Public School" />
  <meta property="og:locale" content="en_US" />
  
  <!-- Twitter Card Meta Tags -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="Vikas Public School - Excellence in Education" />
  <meta name="twitter:description" content="Premier educational institution offering quality education since 2006. Admissions open for 2025-26." />
  <meta name="twitter:image" content="https://vikaspublicschool.edu/assets/logo.png" />
  <meta name="twitter:image:alt" content="Vikas Public School Logo" />
  
  <!-- Additional SEO Meta Tags -->
  <meta name="theme-color" content="#4f46e5" />
  <meta name="msapplication-TileColor" content="#4f46e5" />
  <meta name="application-name" content="Vikas Public School" />
  
  <!-- Geo Meta Tags (Update with actual location) -->
  <meta name="geo.region" content="IN" />
  <meta name="geo.placename" content="Your City, Your State" />
  <meta name="geo.position" content="latitude;longitude" />
  <meta name="ICBM" content="latitude, longitude" />
  
  <!-- Favicon -->
  <link rel="icon" type="image/svg+xml" href="assets/favicon.svg">
  <link rel="alternate icon" href="assets/favicon.svg">
  <link rel="apple-touch-icon" href="assets/logo.png">
  <link rel="shortcut icon" href="assets/favicon.svg">
  
  <!-- PWA Manifest -->
  <link rel="manifest" href="manifest.json">
  
  <!-- Preconnect for performance -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preconnect" href="https://www.gstatic.com">
  <link rel="preconnect" href="https://cdnjs.cloudflare.com">
  
  <!-- DNS Prefetch -->
  <link rel="dns-prefetch" href="//fonts.googleapis.com">
  <link rel="dns-prefetch" href="//fonts.gstatic.com">
  <link rel="dns-prefetch" href="//www.gstatic.com">
  <link rel="dns-prefetch" href="//cdnjs.cloudflare.com">
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:wght@400;600;700&display=swap"
    rel="stylesheet"
  />
  <link rel="stylesheet" href="css/style.css?v=1.1" />
  <style>
    /* Modern Global Styles */
    :root {
      --primary-color: #4f46e5;
      --primary-dark: #3730a3;
      --primary-light: #e0e7ff;
      --secondary-color: #059669;
      --accent-color: #dc2626;
      --background: #fefefe;
      --surface: #fdfdfd;
      --surface-elevated: #ffffff;
      --text-primary: #1e293b;
      --text-secondary: #64748b;
      --text-muted: #94a3b8;
      --border: #e2e8f0;
      --border-light: #f1f5f9;
      --gradient-primary: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
      --gradient-secondary: linear-gradient(135deg, #059669 0%, #047857 100%);
      --gradient-accent: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%);
      --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
      --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
      --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
      --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);
      --border-radius: 12px;
      --border-radius-lg: 16px;
      --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }
    /* Floating Refresh Button Styles */
    .refresh-fab {
      position: fixed;
      bottom: 100px;
      right: 20px;
      width: 56px;
      height: 56px;
      background: var(--gradient-primary);
      color: #fff;
      border: none;
      border-radius: 50%;
      box-shadow: var(--shadow-lg);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2rem;
      cursor: pointer;
      z-index: 1001;
      transition: box-shadow 0.2s, transform 0.2s;
    }
    .refresh-fab:hover {
      box-shadow: 0 8px 32px rgba(79, 70, 229, 0.25);
      transform: scale(1.08);
      background: var(--primary-dark);
    }
    .refresh-fab:focus {
      outline: 2px solid var(--primary-color);
      outline-offset: 2px;
    }
    @media (max-width: 768px) {
      .refresh-fab {
        bottom: 70px;
        right: 15px;
        width: 48px;
        height: 48px;
        font-size: 1.5rem;
      }
    }
    @media (max-width: 480px) {
      .refresh-fab {
        bottom: 60px;
        right: 10px;
        width: 42px;
        height: 42px;
        font-size: 1.2rem;
      }
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      line-height: 1.6;
      color: var(--text-primary);
      background: var(--background);
      overflow-x: hidden;
    }

    /* Modern Header */
    header {
      position: sticky;
      top: 0;
      z-index: 1000;
      background: rgba(254, 254, 254, 0.95);
      backdrop-filter: blur(20px);
      border-bottom: 1px solid var(--border-light);
      transition: var(--transition);
    }

    /* Smooth scroll behavior */
    html {
      scroll-behavior: smooth;
    }

    /* Modern typography */
    h1, h2, h3, h4, h5, h6 {
      font-family: 'Playfair Display', serif;
      font-weight: 600;
      line-height: 1.2;
      color: var(--text-primary);
    }

    /* Glass morphism effect for cards */
    .glass {
      background: rgba(255, 255, 255, 0.25);
      backdrop-filter: blur(20px);
      border: 1px solid rgba(255, 255, 255, 0.18);
      box-shadow: var(--shadow-xl);
    }

    /* Modern button styles */
    .btn-modern {
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.75rem 1.5rem;
      background: var(--gradient-primary);
      color: white;
      text-decoration: none;
      border-radius: var(--border-radius);
      font-weight: 500;
      transition: var(--transition);
      border: none;
      cursor: pointer;
      box-shadow: var(--shadow-md);
    }

    .btn-modern:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-lg);
    }

    /* Loading animations */
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes slideInRight {
      from {
        opacity: 0;
        transform: translateX(30px);
      }
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }

    /* Intersection Observer animations */
    .animate-on-scroll {
      opacity: 0;
      transform: translateY(30px);
      transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .animate-on-scroll.visible {
      opacity: 1;
      transform: translateY(0);
    }

    /* Floating Notice Board Widget */
    .notice-board-widget {
      position: fixed;
      bottom: 20px;
      right: 20px;
      width: 60px;
      height: 60px;
      background: linear-gradient(135deg, #4f46e5, #7c3aed);
      border-radius: 50%;
      box-shadow: 0 4px 20px rgba(79, 70, 229, 0.3);
      z-index: 999;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 1.5rem;
      border: none;
      overflow: hidden;
    }

    .notice-board-widget:hover {
      transform: scale(1.1);
      box-shadow: 0 6px 25px rgba(79, 70, 229, 0.4);
    }

    .notice-board-widget.expanded {
      width: 320px;
      height: auto;
      border-radius: 16px;
      flex-direction: column;
      align-items: stretch;
      max-height: 400px;
    }

    .notice-widget-header {
      display: none;
      padding: 1rem;
      background: linear-gradient(135deg, #4f46e5, #7c3aed);
      color: white;
      cursor: pointer;
      user-select: none;
      font-weight: 600;
      border-radius: 16px 16px 0 0;
      flex-shrink: 0;
    }

    .notice-board-widget.expanded .notice-widget-header {
      display: flex;
      align-items: center;
    }

    .notice-widget-fab-icon {
      display: block;
      animation: pulse 2s infinite;
    }

    .notice-board-widget.expanded .notice-widget-fab-icon {
      display: none;
    }

    .notice-widget-header:hover {
      background: linear-gradient(135deg, #4338ca, #6d28d9);
    }

    .notice-icon {
      font-size: 1.2rem;
      margin-right: 0.5rem;
    }

    .notice-title {
      flex: 1;
      font-size: 1rem;
    }

    .notice-count {
      background: rgba(255, 255, 255, 0.2);
      padding: 0.25rem 0.5rem;
      border-radius: 12px;
      font-size: 0.875rem;
      margin-right: 0.5rem;
      min-width: 24px;
      text-align: center;
    }

    .notice-toggle {
      font-size: 0.875rem;
      transition: transform 0.3s ease;
    }

    .notice-widget-content {
      display: none;
      max-height: 300px;
      overflow-y: auto;
      background: white;
      border-radius: 0 0 16px 16px;
      flex: 1;
    }

    .notice-board-widget.expanded .notice-widget-content {
      display: block;
    }

    .notice-widget-loading {
      padding: 1.5rem;
      text-align: center;
      color: var(--text-secondary);
      font-style: italic;
      font-size: 0.875rem;
    }

    .notice-item {
      padding: 0.75rem;
      border-bottom: 1px solid var(--border-light);
      transition: background-color 0.2s ease;
    }

    .notice-item:hover {
      background-color: #f8fafc;
    }

    .notice-item:last-child {
      border-bottom: none;
    }

    .notice-category {
      display: inline-block;
      padding: 0.2rem 0.4rem;
      border-radius: 4px;
      font-size: 0.7rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: 0.4rem;
    }

    .notice-category.urgent {
      background: #fee2e2;
      color: #dc2626;
    }

    .notice-category.academic {
      background: #dbeafe;
      color: #2563eb;
    }

    .notice-category.events {
      background: #d1fae5;
      color: #059669;
    }

    .notice-category.general {
      background: #f3e8ff;
      color: #7c3aed;
    }

    .notice-title-text {
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: 0.25rem;
      font-size: 0.85rem;
      line-height: 1.3;
    }

    .notice-date {
      font-size: 0.7rem;
      color: var(--text-secondary);
      margin-bottom: 0.4rem;
    }

    .notice-description {
      font-size: 0.8rem;
      color: var(--text-secondary);
      line-height: 1.3;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }

    .notice-widget-footer {
      padding: 0.75rem;
      text-align: center;
      border-top: 1px solid var(--border-light);
      background: #f8fafc;
      border-radius: 0 0 16px 16px;
      flex-shrink: 0;
    }

    .view-all-notices {
      color: var(--primary);
      text-decoration: none;
      font-weight: 600;
      font-size: 0.8rem;
      padding: 0.4rem 0.8rem;
      border-radius: 6px;
      transition: all 0.2s ease;
      display: inline-block;
    }

    .view-all-notices:hover {
      background: var(--primary);
      color: white;
      text-decoration: none;
    }

    /* Notice badge on FAB */
    .notice-badge {
      position: absolute;
      top: -5px;
      right: -5px;
      background: #ef4444;
      color: white;
      font-size: 0.7rem;
      font-weight: 600;
      padding: 0.2rem 0.4rem;
      border-radius: 10px;
      min-width: 18px;
      text-align: center;
      border: 2px solid white;
      animation: pulse 2s infinite;
    }

    .notice-badge:empty {
      display: none;
    }

    /* Mobile responsiveness */
    @media (max-width: 768px) {
      .notice-board-widget {
        bottom: 15px;
        right: 15px;
        width: 50px;
        height: 50px;
        font-size: 1.3rem;
      }
      
      .notice-board-widget.expanded {
        width: calc(100vw - 30px);
        right: 15px;
        bottom: 15px;
      }
      
      .notice-widget-content {
        max-height: 250px;
      }
    }

    @media (max-width: 480px) {
      .notice-board-widget {
        width: 45px;
        height: 45px;
        font-size: 1.2rem;
      }
      
      .notice-board-widget.expanded {
        width: calc(100vw - 20px);
        right: 10px;
      }
    }

    /* Navigation Notice Badge */
    .nav-badge {
      display: inline-block;
      background: linear-gradient(135deg, #ef4444, #dc2626);
      color: white;
      font-size: 0.75rem;
      font-weight: 600;
      padding: 0.25rem 0.5rem;
      border-radius: 10px;
      margin-left: 0.5rem;
      min-width: 20px;
      text-align: center;
      animation: pulse 2s infinite;
    }

    .nav-badge:empty {
      display: none;
    }

    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.05); }
      100% { transform: scale(1); }
    }
  </style>
  <!-- Include fontawesome icons for social -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  
  <!-- JSON-LD Structured Data for SEO -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "EducationalOrganization",
    "name": "Vikas Public School",
    "alternateName": "VPS",
    "description": "Premier educational institution offering quality education since 2006. Nurturing young minds through holistic development and innovative teaching methods.",
    "url": "https://vikaspublicschool.edu",
    "logo": "https://vikaspublicschool.edu/assets/logo.png",
    "image": "https://vikaspublicschool.edu/assets/school.jpg",
    "foundingDate": "2006",
    "founder": {
      "@type": "Person",
      "name": "Jatashankar Pal"
    },
    "address": {
      "@type": "PostalAddress",
      "streetAddress": "Your School Address",
      "addressLocality": "Your City",
      "addressRegion": "Your State",
      "postalCode": "Your PIN",
      "addressCountry": "IN"
    },
    "contactPoint": {
      "@type": "ContactPoint",
      "telephone": "+91-XXXXXXXXXX",
      "contactType": "Admissions",
      "availableLanguage": ["English", "Hindi"]
    },
    "sameAs": [
      "https://www.facebook.com/vikaspublicschool",
      "https://www.instagram.com/vikaspublicschool",
      "https://www.youtube.com/vikaspublicschool"
    ],
    "subOrganization": [
      {
        "@type": "EducationalOrganization",
        "name": "Primary Section",
        "description": "Classes 1-5"
      },
      {
        "@type": "EducationalOrganization", 
        "name": "Secondary Section",
        "description": "Classes 6-12"
      }
    ],
    "hasCredential": {
      "@type": "EducationalOccupationalCredential",
      "credentialCategory": "CBSE Affiliation"
    }
  }
  </script>
  
  <!-- Website Schema -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebSite",
    "name": "Vikas Public School",
    "url": "https://vikaspublicschool.edu",
    "potentialAction": {
      "@type": "SearchAction",
      "target": "https://vikaspublicschool.edu/?s={search_term_string}",
      "query-input": "required name=search_term_string"
    }
  }
  </script>
  
  <!-- Organization Schema -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Organization",
    "name": "Vikas Public School",
    "url": "https://vikaspublicschool.edu",
    "logo": "https://vikaspublicschool.edu/assets/logo.png",
    "slogan": "Excellence in Education",
    "description": "Vikas Public School - Empowering Future Leaders through Quality Education",
    "foundingDate": "2006",
    "address": {
      "@type": "PostalAddress",
      "streetAddress": "Your School Address",
      "addressLocality": "Your City", 
      "addressRegion": "Your State",
      "postalCode": "Your PIN",
      "addressCountry": "IN"
    },
    "contactPoint": {
      "@type": "ContactPoint",
      "telephone": "+91-XXXXXXXXXX",
      "contactType": "customer service"
    }
  }
  </script>
  
  <!-- Firebase SDKs - Free Tier Optimized -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
</head>
<body>
  <!-- Reading Progress Bar -->
  <div id="reading-progress" style="
    position: fixed;
    top: 0;
    left: 0;
    width: 0%;
    height: 3px;
    background: var(--primary-color);
    z-index: 9999;
    transition: width 0.3s ease;
  "></div>
  
  <header>
    <div class="header-container">
      <div class="logo-section">
        <img
          src="assets/logo.png"
          alt="Vikas Public School Logo"
          class="logo-img"
          aria-hidden="false"
          aria-label="School Logo"
          loading="eager"
          fetchpriority="high"
        />
        <div class="logo-text">
          <h1 class="school-name">Vikas Public School</h1>
          <p class="school-tagline">Excellence in Education</p>
        </div>
      </div>
      
      <nav class="main-nav" aria-label="Primary navigation" id="main-nav">
        <ul class="nav-menu">
          <li><a href="#hero" class="nav-link">Home</a></li>
          <li><a href="#about" class="nav-link">About</a></li>
          <li><a href="#academics" class="nav-link">Academics</a></li>
          <li><a href="#faculty" class="nav-link">Faculty</a></li>
          <li><a href="#events" class="nav-link">Notice Board</a></li>
          <li><a href="#gallery" class="nav-link">Gallery</a></li>
          <li><a href="#testimonials" class="nav-link">Testimonials</a></li>
          <li><a href="#faq" class="nav-link">FAQ</a></li>
          <li><a href="#admissions" class="nav-link">Admissions</a></li>
          <li><a href="#contact" class="nav-link">Contact</a></li>
         <li><a href="mandatory-public-disclosure.html" class="nav-link">Mandatory Public Disclosure</a></li>
        </ul>
      </nav>
      
      <div class="header-actions">
        <button
          class="hamburger"
          aria-label="Toggle navigation menu"
          aria-expanded="false"
          onclick="toggleMenu()"
          onkeypress="event.key === 'Enter' && toggleMenu()"
        >
          <span></span>
          <span></span>
          <span></span>
        </button>
      </div>
    </div>
  </header>

  <!-- Notice Ticker Bar -->
  <div class="notice-ticker-bar" id="notice-ticker-bar">
    <div class="notice-ticker-container">
      <div class="notice-bell-icon" onclick="toggleNoticePanel()">
        <div class="bell-icon">🔔</div>
        <div class="notice-count-badge" id="notice-count-badge">0</div>
      </div>
      <div class="notice-ticker-content">
        <div class="notice-ticker-text" id="notice-ticker-text">
          <span class="ticker-item">📌 Loading latest notices...</span>
        </div>
      </div>
      <div class="notice-view-all" onclick="toggleNoticePanel()">
        View All
      </div>
    </div>
  </div>

  <!-- Notice Panel (Collapsible) -->
  <div class="notice-panel" id="notice-panel">
    <div class="notice-panel-header">
      <h3>📌 School Notice Board</h3>
      <button class="notice-panel-close" onclick="toggleNoticePanel()">✕</button>
    </div>
    <div class="notice-panel-content" id="notice-panel-content">
      <div class="notice-loading">Loading notices...</div>
    </div>
  </div>

  <section class="hero" id="hero" role="banner" aria-label="Welcome to Vikas Public School">
    <div class="hero-content">
      <div class="hero-skeleton" style="display: none;">
        <div class="skeleton-title"></div>
        <div class="skeleton-subtitle"></div>
        <div class="skeleton-buttons">
          <div class="skeleton-button"></div>
          <div class="skeleton-button"></div>
        </div>
      </div>
      <div class="hero-actual-content" style="display: none;">
        <h1 class="hero-title"></h1>
        <p class="hero-subtitle"></p>
        <div class="hero-actions">
          <a href="#admissions" class="cta-button primary" aria-label="Learn about admissions process">Apply for Admission</a>
          <a href="#about" class="cta-button secondary" aria-label="Learn more about our school">Learn More</a>
        </div>
      </div>
    </div>
  </section>

  <main>
    <section class="section" id="about" tabindex="-1">
      <div class="about-container">
        <div class="about-header">
          <h2>About Us</h2>
          <p class="about-intro">
            Vikas Public School, established in 2006, is committed to nurturing young minds through
            holistic education. Our mission is to foster intellectual curiosity, critical thinking,
            and responsible citizenship through a dynamic curriculum and dedicated faculty.
          </p>
        </div>

        <div class="about-content">
          <!-- Combined Leadership and Highlights Section for better space usage -->
          <div class="about-main-content">
            <!-- Leadership Section -->
            <div class="leadership-section">
              <h3>Our Leadership</h3>
              <div class="leadership-grid">
                <div class="profile-card manager-profile">
                  <div class="profile-image">
                    <img src="assets/IMG-20250726-WA0016.jpg" alt="Jatashankar Pal, Manager - Vikas Public School Leadership Team" loading="lazy" />
                  </div>
                  <div class="profile-info">
                    <h4>Jatashankar Pal</h4>
                    <span class="position">Manager</span>
                    <p class="description">Leading the institution with vision and dedication to excellence in education.</p>
                  </div>
                </div>
                
                <div class="profile-card principal-profile">
                  <div class="profile-image">
                    <img src="assets/IMG-20250726-WA0017.jpg" alt="School Principal - Vikas Public School Leadership" loading="lazy" />
                  </div>
                  <div class="profile-info">
                    <h4>Principal</h4>
                    <span class="position">Principal</span>
                    <p class="description">Committed to fostering academic excellence and character development.</p>
                  </div>
                </div>
              </div>
            </div>

            <!-- Highlights Section -->
            <div class="highlights-section">
              <h3>What Makes Us Special</h3>
              <div class="highlights-grid">
                <div class="highlight-card">
                  <div class="highlight-icon">🏛️</div>
                  <h4>CBSE Affiliation</h4>
                  <p>Accredited standards ensuring quality education</p>
                </div>
                
                <div class="highlight-card">
                  <div class="highlight-icon">🏫</div>
                  <h4>Modern Campus</h4>
                  <p>Smart classrooms, libraries, science labs, and sports facilities</p>
                </div>
                
                <div class="highlight-card">
                  <div class="highlight-icon">🎯</div>
                  <h4>Holistic Development</h4>
                  <p>Focus on academics, co-curricular activities, and personal growth</p>
                </div>
                
                <div class="highlight-card">
                  <div class="highlight-icon">🛡️</div>
                  <h4>Safe Environment</h4>
                  <p>Inclusive and secure learning atmosphere for all students</p>
                </div>
              </div>
            </div>
          </div>

          <!-- Call to Action -->
          <div class="about-actions">
            <a href="#admissions" class="cta-button primary">Explore Admissions</a>
            <a href="#contact" class="cta-button secondary">Contact Us</a>
           <a href="mandatory-public-disclosure.html" class="cta-button secondary">Mandatory Public Disclosure</a>
          </div>
        </div>
      </div>
    </section>

    <section class="section" id="academics" tabindex="-1" aria-labelledby="academics-heading">
      <h2 id="academics-heading">Academics</h2>
      <p>
        At Vikas Public School, we offer a comprehensive curriculum that nurtures academic excellence and critical thinking skills.
      </p>
      <ul>
        <li><strong>Curriculum:</strong> CBSE syllabus from Nursery to Class XII.</li>
        <li><strong>Special Programs:</strong> STEM initiatives, Coding clubs, Language enrichment.</li>
        <li><strong>Assessment:</strong> Continuous Evaluation, Project Based Learning, Olympiads preparation.</li>
        <li><strong>Extra-Curricular:</strong> Art, Music, Dance, Debate, and Sports to nurture talents.</li>
      </ul>
    </section>

    <section class="section" id="faculty" tabindex="-1" aria-labelledby="faculty-heading">
      <h2 id="faculty-heading">Our Faculty</h2>
      <ul class="faculty-list" aria-live="polite">
        <li class="faculty-member">
          <img src="assets/faculty1.jpg" alt="Ms. Priya Sharma" class="faculty-photo" />
          <div class="faculty-info">
            <h3>Ms. Priya Sharma</h3>
            <p>Head of Science Department - 15 years of teaching experience and passion for student mentoring.</p>
          </div>
        </li>
        <li class="faculty-member">
          <img src="assets/faculty2.jpg" alt="Mr. Arjun Singh" class="faculty-photo" />
          <div class="faculty-info">
            <h3>Mr. Arjun Singh</h3>
            <p>Mathematics Teacher - Expert in advanced problem solving and Olympiad training.</p>
          </div>
        </li>
        <li class="faculty-member">
          <img src="assets/faculty3.jpg" alt="Mrs. Neha Verma" class="faculty-photo" />
          <div class="faculty-info">
            <h3>Mrs. Neha Verma</h3>
            <p>English Literature - Creative curriculum developer and drama club advisor.</p>
          </div>
        </li>
      </ul>
    </section>

    <section class="section" id="events" tabindex="-1" aria-labelledby="events-heading">
      <h2 id="events-heading">Notice Board & Events</h2>
      
      <!-- Notice Category Filters -->
      <div class="notice-filters">
        <button class="filter-btn active" data-filter="all" aria-label="Show all notices">
          <i class="fas fa-list"></i> All
        </button>
        <button class="filter-btn" data-filter="urgent" aria-label="Show urgent notices">
          <i class="fas fa-exclamation-triangle"></i> Urgent
        </button>
        <button class="filter-btn" data-filter="academic" aria-label="Show academic notices">
          <i class="fas fa-graduation-cap"></i> Academic
        </button>
        <button class="filter-btn" data-filter="events" aria-label="Show event notices">
          <i class="fas fa-calendar-alt"></i> Events
        </button>
        <button class="filter-btn" data-filter="general" aria-label="Show general notices">
          <i class="fas fa-info-circle"></i> General
        </button>
      </div>

      <!-- Notice Board List -->
      <ul class="notices-list" aria-live="polite">
        <li class="notice-item urgent" data-category="urgent">
          <div class="notice-badge urgent-badge">
            <i class="fas fa-exclamation-triangle"></i> Urgent
          </div>
          <div class="notice-content">
            <h3>Mid-term Examination Schedule Released</h3>
            <div class="notice-meta">
              <span class="notice-date">
                <i class="fas fa-calendar"></i> Posted: July 27, 2025
              </span>
              <span class="notice-valid">
                <i class="fas fa-clock"></i> Valid until: September 30, 2025
              </span>
            </div>
            <p>Mid-term examinations for all classes will commence from September 15, 2025. Students must prepare according to the detailed schedule available in the admissions section.</p>
          </div>
        </li>
        
        <li class="notice-item events" data-category="events">
          <div class="notice-badge events-badge">
            <i class="fas fa-calendar-alt"></i> Event
          </div>
          <div class="notice-content">
            <h3>Annual Sports Day - August 15, 2025</h3>
            <div class="notice-meta">
              <span class="notice-date">
                <i class="fas fa-calendar"></i> Posted: July 25, 2025
              </span>
            </div>
            <p>Join us for a day full of sportsmanship and fun activities for all students. Participation forms available at the sports department.</p>
          </div>
        </li>
        
        <li class="notice-item academic" data-category="academic">
          <div class="notice-badge academic-badge">
            <i class="fas fa-graduation-cap"></i> Academic
          </div>
          <div class="notice-content">
            <h3>Science Exhibition - September 10, 2025</h3>
            <div class="notice-meta">
              <span class="notice-date">
                <i class="fas fa-calendar"></i> Posted: July 20, 2025
              </span>
            </div>
            <p>A platform for young innovators to showcase their projects and experiments. Registration deadline: August 25, 2025.</p>
          </div>
        </li>
        
        <li class="notice-item general" data-category="general">
          <div class="notice-badge general-badge">
            <i class="fas fa-info-circle"></i> General
          </div>
          <div class="notice-content">
            <h3>Parent-Teacher Meeting - October 5, 2025</h3>
            <div class="notice-meta">
              <span class="notice-date">
                <i class="fas fa-calendar"></i> Posted: July 18, 2025
              </span>
            </div>
            <p>Discuss your child's progress and participate in school development feedback sessions. Meeting timings: 9 AM to 4 PM.</p>
          </div>
        </li>
        
        <li class="notice-item urgent" data-category="urgent">
          <div class="notice-badge urgent-badge">
            <i class="fas fa-exclamation-triangle"></i> Urgent
          </div>
          <div class="notice-content">
            <h3>Holiday Notice - Independence Day</h3>
            <div class="notice-meta">
              <span class="notice-date">
                <i class="fas fa-calendar"></i> Posted: July 27, 2025
              </span>
              <span class="notice-valid">
                <i class="fas fa-clock"></i> Valid until: August 15, 2025
              </span>
            </div>
            <p>School will remain closed on August 15, 2025, in observance of Independence Day. Regular classes will resume on August 16, 2025.</p>
          </div>
        </li>
      </ul>
      
      <!-- View More Button -->
      <div class="notice-actions">
        <button class="cta-button secondary" onclick="loadMoreNotices()">
          <i class="fas fa-plus"></i> Load More Notices
        </button>
      </div>
    </section>

    <section class="section" id="gallery" tabindex="-1" aria-labelledby="gallery-heading">
      <h2 id="gallery-heading">Gallery</h2>
      <div class="gallery" role="list" aria-label="School photo gallery">
        <a href="#" data-img="assets/gallery7.jpg" tabindex="0" role="listitem" class="gallery-link">
          <img src="assets/gallery7.jpg" alt="Students conducting science experiments in modern laboratory - Vikas Public School" loading="lazy" />
        </a>
        <a href="#" data-img="assets/gallery8.jpg" tabindex="0" role="listitem" class="gallery-link">
          <img src="assets/gallery8.jpg" alt="Annual sports day celebration at Vikas Public School" loading="lazy" />
        </a>
        <a href="#" data-img="assets/gallery9.jpg" tabindex="0" role="listitem" class="gallery-link">
          <img src="assets/gallery9.jpg" alt="Cultural program performance by students" loading="lazy" />
        </a>
        <a href="#" data-img="assets/gallery10.jpg" tabindex="0" role="listitem" class="gallery-link">
          <img src="assets/gallery10.jpg" alt="Classroom learning environment with engaged students" loading="lazy" />
        </a>
        <a href="#" data-img="assets/gallery11.jpg" tabindex="0" role="listitem" class="gallery-link">
          <img src="assets/gallery11.jpg" alt="School assembly and student activities" loading="lazy" />
        </a>
        <a href="#" data-img="assets/gallery12.jpg" tabindex="0" role="listitem" class="gallery-link">
          <img src="assets/gallery12.jpg" alt="School infrastructure and learning spaces" loading="lazy" />
        </a>
        <a href="#" data-img="assets/gallery13.jpg" tabindex="0" role="listitem" class="gallery-link">
          <img src="assets/gallery13.jpg" alt="Student achievements and recognition ceremony" loading="lazy" />
        </a>
      </div>
      <!-- Modal for image viewing -->
      <div class="gallery-modal" aria-modal="true" role="dialog" tabindex="-1">
        <span class="close-modal" tabindex="0" aria-label="Close image modal">&times;</span>
        <span class="modal-prev" aria-label="Previous image">&#10094;</span>
        <span class="modal-next" aria-label="Next image">&#10095;</span>
        <div class="modal-content">
          <img src="" alt="Gallery image enlarged">
        </div>
      </div>
    </section>

    <section class="section" id="testimonials" tabindex="-1" aria-labelledby="testimonials-heading">
      <h2 id="testimonials-heading">Testimonials</h2>
      <ul class="testimonial-list" aria-live="polite">
        <li class="testimonial-item">
          <div class="testimonial-info">
            <h3>Ravi Kumar, Parent</h3>
            <p>
              "Vikas Public School has transformed my child's life with excellent academics and a nurturing environment."
            </p>
          </div>
        </li>
        <li class="testimonial-item">
          <div class="testimonial-info">
            <h3>Meera Singh, Student</h3>
            <p>
              "The teachers here are supportive and the activities are fun and enriching. I love being part of the school."
            </p>
          </div>
        </li>
        <li class="testimonial-item">
          <div class="testimonial-info">
            <h3>Anita Joshi, Parent</h3>
            <p>
              "Strong focus on all-round development helped my daughter flourish in academics and sports."
            </p>
          </div>
        </li>
      </ul>
    </section>

    <section class="section" id="faq" tabindex="-1" aria-labelledby="faq-heading">
      <h2 id="faq-heading">Frequently Asked Questions</h2>
      <ul class="faq-list" role="list">
        <li class="faq-item">
          <button class="faq-question" aria-expanded="false" aria-controls="faq1" id="faq1-btn">
            What is the admission process?
          </button>
          <div class="faq-answer" id="faq1" role="region" aria-labelledby="faq1-btn">
            We have an application followed by an entrance test and interview. Detailed steps are available in the Admissions section.
          </div>
        </li>
        <li class="faq-item">
          <button class="faq-question" aria-expanded="false" aria-controls="faq2" id="faq2-btn">
            Do you offer transportation facilities?
          </button>
          <div class="faq-answer" id="faq2" role="region" aria-labelledby="faq2-btn">
            Yes, we provide safe and reliable transport services covering major areas of Bengaluru.
          </div>
        </li>
        <li class="faq-item">
          <button class="faq-question" aria-expanded="false" aria-controls="faq3" id="faq3-btn">
            What co-curricular activities are available?
          </button>
          <div class="faq-answer" id="faq3" role="region" aria-labelledby="faq3-btn">
            Students can participate in sports, music, dance, arts, debate, coding clubs, and more.
          </div>
        </li>
      </ul>
    </section>

    <section class="section" id="admissions" tabindex="-1" aria-labelledby="admissions-heading">
      <h2 id="admissions-heading">Admissions</h2>
      <p>
        Admissions open for academic year 2025-26. Start your admission process by downloading our admission form below:
      </p>
      <div class="buttons" style="margin-top: 1.5rem;">
        <a href="assets/admission-form.html" download="VPS-Admission-Form.html" class="btn-modern primary">
          <i class="fas fa-download"></i> Download Admission Form
        </a>
      </div>
      <div style="margin-top: 2rem;">
        <h3>Admission Process</h3>
        <ul>
          <li>Download and fill the admission form completely</li>
          <li>Attach all required documents as mentioned in the form</li>
          <li>Submit the completed form along with documents at the school office</li>
          <li>Admission test/interview will be scheduled for eligible candidates</li>
          <li>Final admission will be confirmed based on test/interview results</li>
        </ul>
      </div>
      <div style="margin-top: 2rem;">
        <h3>Required Documents</h3>
        <ul>
          <li>Birth Certificate</li>
          <li>Transfer Certificate from previous school (if applicable)</li>
          <li>Report Card of previous class</li>
          <li>Passport size photographs (recent)</li>
          <li>Address Proof</li>
          <li>Aadhar Card copy of student and parents</li>
          <li>Category Certificate (if applicable)</li>
        </ul>
      </div>
      <p><strong>Eligibility:</strong> Nursery to Class XII</p>
      <p>
        <strong>Process:</strong> Application &rarr; Entrance Test &rarr; Interview &rarr; Admission
        Confirmation
      </p>
      <p>
        <strong>Required Documents:</strong> Birth Certificate, Previous Year’s Marksheet,
        Passport-size Photographs, Address Proof.
      </p>
      <div class="cta-wrapper">
        <a href="assets/admission_form.pdf" class="cta-button" download>Download Admission Form</a>
      </div>
    </section>

    <section class="section" id="contact" tabindex="-1" aria-labelledby="contact-heading">
      <h2 id="contact-heading">Contact Us</h2>
      <address>
        <p><strong>Address:</strong> Jaunpur, UP India 222146</p>
        <p><strong>Email:</strong> <a href="mailto:info@vikasschool.edu.in">info@vikasschool.edu.in</a></p>
        <p><strong>Phone:</strong> +91-98765 43210</p>
        <p><strong>Office Hours:</strong> 9 AM – 4 PM, Monday to Saturday</p>
      </address>
      <form
        action="#"
        method="post"
        aria-label="Contact form"
        onsubmit="return handleSubmit(event)"
        novalidate
      >
        <input
          type="text"
          name="name"
          id="name"
          placeholder="Your Name"
          required
          aria-required="true"
          aria-describedby="name-error"
        />
        <span id="name-error" style="color:#d32f2f; font-size:0.85rem; display:none;"
          >Please enter your name.</span
        >

        <input
          type="email"
          name="email"
          id="email"
          placeholder="Your Email"
          required
          aria-required="true"
          aria-describedby="email-error"
        />
        <span id="email-error" style="color:#d32f2f; font-size:0.85rem; display:none;"
          >Please enter a valid email.</span
        >

        <textarea
          name="message"
          id="message"
          rows="4"
          placeholder="Your Message"
          aria-describedby="message-help"
        ></textarea>
        <small id="message-help" style="color:#666;">Optional</small>

        <button type="submit">Send Message</button>
      </form>
    </section>
  </main>

  <footer role="contentinfo">
    <div class="footer-container">
      <div class="footer-content">
        <div class="footer-section">
          <h3>Vikas Public School</h3>
          <p>Excellence in Education since 2006. Nurturing young minds through holistic development and innovative teaching methodologies.</p>
          <address id="school-address">
            <strong>Address:</strong> <span id="db-address">Loading address...</span><br>
            <span id="db-city-state">Loading city, state...</span> - <span id="db-pincode">PIN</span><br>
            <strong>Phone:</strong> <a href="tel:+91XXXXXXXXXX" id="db-phone">+91-XXXXXXXXXX</a><br>
            <strong>Email:</strong> <a href="mailto:info@vikaspublicschool.edu" id="db-email">info@vikaspublicschool.edu</a>
          </address>
        </div>
        
        <div class="footer-section">
          <h4>Quick Links</h4>
          <nav aria-label="Footer navigation">
            <ul>
              <li><a href="#about">About Us</a></li>
              <li><a href="#academics">Academics</a></li>
              <li><a href="#faculty">Faculty</a></li>
              <li><a href="#admissions">Admissions</a></li>
              <li><a href="#gallery">Gallery</a></li>
              <li><a href="#contact">Contact</a></li>
            </ul>
          </nav>
        </div>
        
        <div class="footer-section">
          <h4>Important Information</h4>
          <ul>
            <li><a href="assets/admission-form.html">Admission Form</a></li>
            <li><a href="#faq">FAQ</a></li>
            <li><a href="#events">Notice Board</a></li>
            <li><a href="#testimonials">Testimonials</a></li>
          </ul>
        </div>
        
        <div class="footer-section">
          <h4>Follow Us</h4>
          <div class="social-icons" aria-label="Social media links">
            <a href="https://facebook.com/vikaspublicschool" target="_blank" rel="noopener" aria-label="Facebook - Vikas Public School" class="facebook">
              <i class="fab fa-facebook-f"></i>
            </a>
            <a href="https://instagram.com/vikaspublicschool" target="_blank" rel="noopener" aria-label="Instagram - Vikas Public School" class="instagram">
              <i class="fab fa-instagram"></i>
            </a>
            <a href="https://youtube.com/vikaspublicschool" target="_blank" rel="noopener" aria-label="YouTube - Vikas Public School" class="youtube">
              <i class="fab fa-youtube"></i>
            </a>
            <a href="https://linkedin.com/company/vikaspublicschool" target="_blank" rel="noopener" aria-label="LinkedIn - Vikas Public School" class="linkedin">
              <i class="fab fa-linkedin-in"></i>
            </a>
          </div>
        </div>
      </div>
      
      <div class="footer-bottom">
        <div class="copyright">
          <p>&copy; 2025 Vikas Public School. All Rights Reserved. | 
          <a href="/privacy-policy">Privacy Policy</a> | 
          <a href="/terms-of-service">Terms of Service</a></p>
        </div>
        <div class="footer-meta">
          <p>Affiliated to CBSE | Established 2006 | Quality Education for All</p>
        </div>
      </div>
    </div>
  </footer>

  <script src="js/main.js?v=1.1"></script>
  
  <!-- Google Analytics 4 (Replace GA_MEASUREMENT_ID with your actual ID) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=GA_MEASUREMENT_ID"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'GA_MEASUREMENT_ID', {
      page_title: document.title,
      page_location: window.location.href,
      custom_map: {'dimension1': 'school_section'}
    });
    
    // Track school section interactions
    document.addEventListener('click', function(e) {
      if (e.target.matches('a[href^="#"]')) {
        const section = e.target.getAttribute('href').replace('#', '');
        gtag('event', 'section_view', {
          'school_section': section,
          'event_category': 'navigation'
        });
      }
    });
  </script>
  
  <!-- JSON-LD for FAQ Page (if you have FAQ content) -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "FAQPage",
    "mainEntity": [
      {
        "@type": "Question",
        "name": "What is the admission process for Vikas Public School?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "The admission process involves filling out an application form, document verification, and an interaction session. Visit our admissions section for detailed information."
        }
      },
      {
        "@type": "Question", 
        "name": "What curriculum does Vikas Public School follow?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Vikas Public School follows the CBSE curriculum with a focus on holistic development including academics, sports, and co-curricular activities."
        }
      }
    ]
  }
  </script>
  
  <!-- Firebase Configuration - Free Tier Optimized -->
  <script>
    // Clear any potentially cached hero data that might be causing issues
    localStorage.removeItem('heroData');
    localStorage.removeItem('heroCacheTime');
    
    // Also clear any other cached data that might interfere
    const keysToRemove = [];
    for (let i = 0; i < localStorage.length; i++) {
      const key = localStorage.key(i);
      if (key && key.includes('hero')) {
        keysToRemove.push(key);
      }
    }
    keysToRemove.forEach(key => localStorage.removeItem(key));

    // Only show hero section when Firestore data is loaded
    function updateHeroSection(heroData) {
      const heroElement = document.querySelector('.hero');
      if (heroElement) {
        const heroSkeleton = heroElement.querySelector('.hero-skeleton');
        const heroActualContent = heroElement.querySelector('.hero-actual-content');
        const heroTitle = heroElement.querySelector('.hero-title');
        const heroSubtitle = heroElement.querySelector('.hero-subtitle');

        // Set content only if Firestore data is present
        if (heroData && heroTitle && heroSubtitle) {
          heroTitle.textContent = heroData.title || '';
          heroSubtitle.textContent = heroData.subtitle || '';
        }

        // Hide skeleton, show actual content only if Firestore data is present
        if (heroSkeleton) {
          heroSkeleton.style.display = 'none';
        }
        if (heroActualContent) {
          if (heroData) {
            heroActualContent.style.display = '';
            heroActualContent.classList.add('loaded');
          } else {
            heroActualContent.style.display = 'none';
          }
        }

        // Handle background image
        if (heroData && heroData.backgroundImage && heroData.backgroundImage.trim() !== '') {
          heroElement.style.setProperty('--hero-bg-image', `url(${heroData.backgroundImage})`);
          heroElement.classList.add('has-custom-image');
        } else {
          heroElement.classList.remove('has-custom-image');
          heroElement.style.removeProperty('--hero-bg-image');
        }
      }
    }
    
    // Wait for DOM to be fully loaded before running Firebase code
    document.addEventListener('DOMContentLoaded', function() {
      // Firebase configuration for free tier
      const firebaseConfig = {
        apiKey: "AIzaSyDZH0ZcGAtrILqdRdI5dIhZCUA0eAJzRpE",
        authDomain: "vpschool-918d6.firebaseapp.com",
        projectId: "vpschool-918d6",
        storageBucket: "vpschool-918d6.firebasestorage.app",
        messagingSenderId: "290237090155",
        appId: "1:290237090155:web:90356cb12d25d5a0a8a42e",
        measurementId: "G-02JK84S8NH"
      };
      
      // Initialize Firebase for main website
      let db;
      if (typeof firebase !== 'undefined') {
        try {
          firebase.initializeApp(firebaseConfig);
          db = firebase.firestore();
          
          // Enable offline persistence for free tier efficiency
          db.enablePersistence({ synchronizeTabs: true })
            .then(() => {
              console.log('Firebase persistence enabled - optimized for free tier!');
            })
            .catch(() => {
              console.log('Persistence not available in this browser');
            });
          
          console.log('Firebase initialized for main website');
          
          // Load dynamic content efficiently
          loadDynamicContent();
        } catch (error) {
          console.log('Firebase not available, hero section will remain hidden.');
        }
      } else {
        console.log('Firebase not loaded, hero section will remain hidden.');
      }
      
      // Enhanced cache checking function
      async function shouldUseCache(type, cachedTime, now, CACHE_DURATION) {
        // First check if cache is within time limit
        if (!cachedTime || (now - cachedTime >= CACHE_DURATION)) {
          return false;
        }
        
        try {
          // Check if admin has invalidated this cache
          const cacheDoc = await db.collection('cache').doc(type).get();
          if (cacheDoc.exists) {
            const cacheInfo = cacheDoc.data();
            const lastUpdated = cacheInfo.lastUpdated;
            
            // If admin updated content after our cache, invalidate it
            if (lastUpdated > cachedTime) {
              console.log(`Cache invalidated for ${type} - admin updated content`);
              return false;
            }
          }
          
          return true;
        } catch (error) {
          console.log(`Error checking cache invalidation for ${type}, using time-based cache:`, error);
          return (now - cachedTime < CACHE_DURATION);
        }
      }

      // Free tier optimized data loading with auto-invalidation
      async function loadDynamicContent() {
        try {
          const now = Date.now();
          const CACHE_DURATION = 24 * 60 * 60 * 1000; // 24 hours
          
          // Load faculty data with smart caching
          const facultyCache = localStorage.getItem('facultyData');
          const facultyCacheTime = parseInt(localStorage.getItem('facultyCacheTime'));
          
          if (facultyCache && await shouldUseCache('faculty', facultyCacheTime, now, CACHE_DURATION)) {
            // Use cached data to minimize reads
            console.log('Using cached faculty data');
            updateFacultySection(JSON.parse(facultyCache));
          } else {
            // Fetch fresh data only when needed
            console.log('Fetching fresh faculty data');
            const facultySnapshot = await db.collection('faculty').get();
            const facultyData = facultySnapshot.docs.map(doc => ({id: doc.id, ...doc.data()}));
            
            // Cache the data
            localStorage.setItem('facultyData', JSON.stringify(facultyData));
            localStorage.setItem('facultyCacheTime', now.toString());
            
            console.log('Faculty data loaded:', facultyData); // Debug log
            updateFacultySection(facultyData);
          }
          
          // Load testimonials with smart caching
          const testimonialsCache = localStorage.getItem('testimonialsData');
          const testimonialsCacheTime = parseInt(localStorage.getItem('testimonialsCacheTime'));
          
          if (testimonialsCache && await shouldUseCache('testimonials', testimonialsCacheTime, now, CACHE_DURATION)) {
            console.log('Using cached testimonials data');
            updateTestimonialsSection(JSON.parse(testimonialsCache));
          } else {
            console.log('Fetching fresh testimonials data');
            const testimonialsSnapshot = await db.collection('testimonials').get();
            const testimonialsData = testimonialsSnapshot.docs.map(doc => ({id: doc.id, ...doc.data()}));
            
            localStorage.setItem('testimonialsData', JSON.stringify(testimonialsData));
            localStorage.setItem('testimonialsCacheTime', now.toString());
            
            updateTestimonialsSection(testimonialsData);
          }
          
          // Load gallery data with smart caching
          const galleryCache = localStorage.getItem('galleryData');
          const galleryCacheTime = parseInt(localStorage.getItem('galleryCacheTime'));
          
          if (galleryCache && await shouldUseCache('gallery', galleryCacheTime, now, CACHE_DURATION)) {
            console.log('Using cached gallery data');
            updateGallerySection(JSON.parse(galleryCache));
          } else {
            console.log('Fetching fresh gallery data');
            const gallerySnapshot = await db.collection('gallery').get();
            const galleryData = gallerySnapshot.docs.map(doc => ({id: doc.id, ...doc.data()}));
            
            localStorage.setItem('galleryData', JSON.stringify(galleryData));
            localStorage.setItem('galleryCacheTime', now.toString());
            
            updateGallerySection(galleryData);
          }
          
          // Load events data with smart caching
          const eventsCache = localStorage.getItem('eventsData');
          const eventsCacheTime = parseInt(localStorage.getItem('eventsCacheTime'));
          
          if (eventsCache && await shouldUseCache('events', eventsCacheTime, now, CACHE_DURATION)) {
            console.log('Using cached events data');
            updateEventsSection(JSON.parse(eventsCache));
          } else {
            console.log('Fetching fresh events data');
            const eventsSnapshot = await db.collection('events').get();
            const eventsData = eventsSnapshot.docs.map(doc => ({id: doc.id, ...doc.data()}));
            
            localStorage.setItem('eventsData', JSON.stringify(eventsData));
            localStorage.setItem('eventsCacheTime', now.toString());
            
            updateEventsSection(eventsData);
          }
          
          // Load hero section data
          await loadSettingsData('hero', function(heroData) {
            // Only show hero section if Firestore data is loaded
            updateHeroSection(heroData);
          });
          
          // Load about section data
          await loadSettingsData('about', updateAboutSection);
          
          // Load academics section data
          await loadSettingsData('academics', updateAcademicsSection);
          
          // Load logo data
          await loadSettingsData('logo', updateLogoSection);
          
          // Load school info data
          await loadSettingsData('school-info', updateSchoolInfoSection);
          
          // Load contact data
          await loadSettingsData('contact', updateContactSection);
          
          // Load FAQ data
          const faqCache = localStorage.getItem('faqData');
          const faqCacheTime = parseInt(localStorage.getItem('faqCacheTime'));
          
          if (faqCache && await shouldUseCache('faq', faqCacheTime, now, CACHE_DURATION)) {
            console.log('Using cached FAQ data');
            updateFaqSection(JSON.parse(faqCache));
          } else {
            console.log('Fetching fresh FAQ data');
            const faqSnapshot = await db.collection('faq').get();
            const faqData = faqSnapshot.docs.map(doc => ({id: doc.id, ...doc.data()}));
            
            localStorage.setItem('faqData', JSON.stringify(faqData));
            localStorage.setItem('faqCacheTime', now.toString());
            
            updateFaqSection(faqData);
          }
          
        } catch (error) {
          console.log('Error loading dynamic content, using static fallback:', error);
        }
      }
      
      // Helper function to load settings data (hero, about, school-info, contact)
      async function loadSettingsData(type, updateFunction) {
        try {
          const now = Date.now();
          const CACHE_DURATION = 24 * 60 * 60 * 1000; // 24 hours
          
          const cacheKey = `${type}Data`;
          const cacheTimeKey = `${type}CacheTime`;
          
          const cachedData = localStorage.getItem(cacheKey);
          const cacheTime = parseInt(localStorage.getItem(cacheTimeKey));
          
          if (cachedData && await shouldUseCache(type, cacheTime, now, CACHE_DURATION)) {
            console.log(`Using cached ${type} data`);
            updateFunction(JSON.parse(cachedData));
          } else {
            console.log(`Fetching fresh ${type} data`);
            const docSnapshot = await db.collection('settings').doc(type).get();
            
            if (docSnapshot.exists) {
              const data = docSnapshot.data();
              
              // Cache the data
              localStorage.setItem(cacheKey, JSON.stringify(data));
              localStorage.setItem(cacheTimeKey, now.toString());
              
              updateFunction(data);
            } else {
              console.log(`No ${type} data found in database, using fallback`);
              // Still call the update function with null/undefined data to handle fallbacks
              updateFunction(null);
            }
          }
        } catch (error) {
          console.log(`Error loading ${type} data, using fallback:`, error);
          // Call update function with null data to handle fallbacks
          updateFunction(null);
        }
      }
      
      // Force refresh function for immediate updates
      function forceRefreshContent() {
        console.log('Force refreshing all content...');
        
        // Clear all cache
        localStorage.removeItem('facultyData');
        localStorage.removeItem('facultyCacheTime');
        localStorage.removeItem('testimonialsData');
        localStorage.removeItem('testimonialsCacheTime');
        localStorage.removeItem('galleryData');
        localStorage.removeItem('galleryCacheTime');
        localStorage.removeItem('eventsData');
        localStorage.removeItem('eventsCacheTime');
        localStorage.removeItem('heroData');
        localStorage.removeItem('heroCacheTime');
        localStorage.removeItem('aboutData');
        localStorage.removeItem('aboutCacheTime');
        localStorage.removeItem('academicsData');
        localStorage.removeItem('academicsCacheTime');
        localStorage.removeItem('logoData');
        localStorage.removeItem('logoCacheTime');
        localStorage.removeItem('school-infoData');
        localStorage.removeItem('school-infoCacheTime');
        localStorage.removeItem('contactData');
        localStorage.removeItem('contactCacheTime');
        
        // Reload content
        loadDynamicContent();
        
        // Show user feedback
        showUpdateNotification('Content refreshed successfully!');
      }
      
      // Show update notification
      function showUpdateNotification(message) {
        // Create notification element
        const notification = document.createElement('div');
        notification.style.cssText = `
          position: fixed;
          top: 20px;
          right: 20px;
          background: #10b981;
          color: white;
          padding: 12px 20px;
          border-radius: 8px;
          box-shadow: 0 4px 12px rgba(0,0,0,0.1);
          z-index: 1000;
          font-family: inherit;
          font-size: 14px;
          opacity: 0;
          transform: translateX(100%);
          transition: all 0.3s ease;
        `;
        notification.textContent = message;
        
        document.body.appendChild(notification);
        
        // Show notification
        setTimeout(() => {
          notification.style.opacity = '1';
          notification.style.transform = 'translateX(0)';
        }, 100);
        
        // Hide and remove notification
        setTimeout(() => {
          notification.style.opacity = '0';
          notification.style.transform = 'translateX(100%)';
          setTimeout(() => {
            if (notification.parentNode) {
              notification.parentNode.removeChild(notification);
            }
          }, 300);
        }, 3000);
      }
      
      // Add keyboard shortcut for force refresh (Ctrl+Shift+R)
      document.addEventListener('keydown', function(e) {
        if (e.ctrlKey && e.shiftKey && e.key === 'R') {
          e.preventDefault();
          forceRefreshContent();
        }
      });
      
      function updateFacultySection(facultyData) {
        const facultyList = document.querySelector('.faculty-list');
        if (facultyList && facultyData.length > 0) {
          facultyList.innerHTML = facultyData.map(faculty => {
            // Handle both regular URLs and base64 data URLs
            const photoSrc = faculty.photo || 'assets/default-faculty.svg'; // fallback image
            const safeName = (faculty.name || 'Faculty Member').replace(/"/g, '&quot;');
            const safeRole = (faculty.role || 'Staff').replace(/"/g, '&quot;');
            const safeDescription = (faculty.description || '').replace(/"/g, '&quot;');
            
            return `
            <li class="faculty-member">
              <img src="${photoSrc}" alt="${safeName}" class="faculty-photo" 
                   onerror="this.src='assets/default-faculty.svg'; console.log('Faculty image failed to load, using fallback');" />
              <div class="faculty-info">
                <h3>${safeName}</h3>
                <p>${safeRole}${safeDescription ? ' - ' + safeDescription : ''}</p>
              </div>
            </li>
          `;
          }).join('');
        }
      }
      
      function updateTestimonialsSection(testimonialsData) {
        const testimonialsList = document.querySelector('.testimonial-list');
        if (testimonialsList && testimonialsData.length > 0) {
          testimonialsList.innerHTML = testimonialsData.map(testimonial => `
            <li class="testimonial-item">
              <div class="testimonial-info">
                <h3>${testimonial.name}, ${testimonial.role}</h3>
                <p>"${testimonial.text}"</p>
              </div>
            </li>
          `).join('');
        }
      }
      
      function updateGallerySection(galleryData) {
        const gallery = document.querySelector('.gallery');
        if (gallery && galleryData.length > 0) {
          gallery.innerHTML = galleryData.map(item => {
            // Handle both regular URLs and base64 data URLs
            const imageSrc = item.src || 'assets/gallery7.jpg'; // fallback image
            const safeAlt = (item.alt || 'Gallery image').replace(/"/g, '&quot;');
            
            return `
            <a href="#" data-img="${imageSrc}" tabindex="0" role="listitem" class="gallery-link">
              <img src="${imageSrc}" alt="${safeAlt}" 
                   onerror="this.src='assets/gallery7.jpg'; console.log('Gallery image failed to load, using fallback');" />
            </a>
          `;
          }).join('');
          
          // Re-attach gallery click events after updating content
          setTimeout(() => {
            if (window.attachGalleryEvents) {
              window.attachGalleryEvents();
            }
          }, 100);
        }
      }
      
      // Update functions for admin panel sections
      function updateAboutSection(aboutData) {
        const aboutSection = document.getElementById('about');
        if (aboutSection && aboutData) {
          // Update about intro content
          const aboutIntro = aboutSection.querySelector('.about-intro');
          if (aboutIntro && aboutData.content) {
            aboutIntro.textContent = aboutData.content;
          }
          
          // Update leadership profiles
          if (aboutData.leadership && Array.isArray(aboutData.leadership)) {
            aboutData.leadership.forEach((leader, index) => {
              const profileCard = aboutSection.querySelector(`.${leader.id}-profile`);
              if (profileCard) {
                // Update image
                const img = profileCard.querySelector('img');
                if (img && leader.image) {
                  img.src = leader.image;
                  img.alt = `${leader.name}, ${leader.position}`;
                }
                
                // Update name
                const nameElement = profileCard.querySelector('h4');
                if (nameElement && leader.name) {
                  nameElement.textContent = leader.name;
                }
                
                // Update position
                const positionElement = profileCard.querySelector('.position');
                if (positionElement && leader.position) {
                  positionElement.textContent = leader.position;
                }
                
                // Update description
                const descriptionElement = profileCard.querySelector('.description');
                if (descriptionElement && leader.description) {
                  descriptionElement.textContent = leader.description;
                }
              }
            });
          }
          
          // Update highlights
          if (aboutData.highlights && Array.isArray(aboutData.highlights)) {
            const highlightCards = aboutSection.querySelectorAll('.highlight-card');
            aboutData.highlights.forEach((highlight, index) => {
              if (highlightCards[index]) {
                const card = highlightCards[index];
                
                // Update icon
                const iconElement = card.querySelector('.highlight-icon');
                if (iconElement && highlight.icon) {
                  iconElement.textContent = highlight.icon;
                }
                
                // Update title
                const titleElement = card.querySelector('h4');
                if (titleElement && highlight.title) {
                  titleElement.textContent = highlight.title;
                }
                
                // Update description
                const descElement = card.querySelector('p');
                if (descElement && highlight.description) {
                  descElement.textContent = highlight.description;
                }
              }
            });
          }
        }
      }
      
      function updateSchoolInfoSection(schoolData) {
        // Update header title if school name is provided
        if (schoolData && schoolData.name) {
          const headerTitle = document.querySelector('header h1');
          if (headerTitle) {
            headerTitle.textContent = schoolData.name;
          }
          
          // Update page title
          document.title = schoolData.name;
        }
        
        // Also update footer address from school info
        updateFooterAddress(schoolData, 'school-info');
      }
      
      function updateContactSection(contactData) {
        const contactSection = document.getElementById('contact');
        if (contactSection && contactData) {
          const address = contactSection.querySelector('address');
          if (address) {
            let addressHTML = '';
            
            if (contactData.address) {
              addressHTML += `<p><strong>Address:</strong> ${contactData.address}</p>`;
            }
            if (contactData.email) {
              addressHTML += `<p><strong>Email:</strong> <a href="mailto:${contactData.email}">${contactData.email}</a></p>`;
            }
            if (contactData.phone) {
              addressHTML += `<p><strong>Phone:</strong> ${contactData.phone}</p>`;
            }
            if (contactData.hours) {
              addressHTML += `<p><strong>Office Hours:</strong> ${contactData.hours}</p>`;
            }
            
            // Only update if we have some data
            if (addressHTML) {
              address.innerHTML = addressHTML;
            }
          }
        }
        
        // Also update footer address from contact data
        updateFooterAddress(contactData, 'contact');
      }
      
      // Helper function to update footer address from Firebase data
      function updateFooterAddress(data, source) {
        if (!data) return;
        
        console.log(`Updating footer address from ${source}:`, data);
        
        // Get footer address elements
        const footerAddress = document.getElementById('db-address');
        const footerPhone = document.getElementById('db-phone');
        const footerEmail = document.getElementById('db-email');
        const cityState = document.getElementById('db-city-state');
        const pincode = document.getElementById('db-pincode');
        
        // Update address - Firebase stores complete address in single field
        if (footerAddress && data.address) {
          footerAddress.textContent = data.address;
          console.log('Footer address updated');
        }
        
        // Hide city/state/pincode for Firebase data (since address is complete)
        if (cityState) {
          cityState.style.display = 'none';
          const prevBr = cityState.previousElementSibling;
          if (prevBr && prevBr.tagName === 'BR') {
            prevBr.style.display = 'none';
          }
        }
        if (pincode) {
          pincode.style.display = 'none';
          // Hide the " - PIN" text
          const parentNode = pincode.parentNode;
          if (parentNode) {
            const textNodes = Array.from(parentNode.childNodes);
            textNodes.forEach(node => {
              if (node.nodeType === Node.TEXT_NODE && node.textContent.includes('PIN')) {
                node.textContent = '';
              }
            });
          }
        }
        
        // Update phone
        if (footerPhone && data.phone) {
          footerPhone.textContent = data.phone;
          footerPhone.href = `tel:${data.phone.replace(/[^+\d]/g, '')}`;
          console.log('Footer phone updated');
        }
        
        // Update email
        if (footerEmail && data.email) {
          footerEmail.textContent = data.email;
          footerEmail.href = `mailto:${data.email}`;
          console.log('Footer email updated');
        }
      }
      
      function updateEventsSection(eventsData) {
        const noticesList = document.querySelector('.notices-list');

        if (noticesList && eventsData.length > 0) {
          // Truncation lengths
          const maxTitleLength = 80;
          const maxDescriptionLength = 120;
          noticesList.innerHTML = eventsData.map((notice, idx) => {
            const safeTitle = (notice.title || 'Notice').replace(/"/g, '&quot;');
            const safeDate = (notice.date || '').replace(/"/g, '&quot;');
            const safeValidUntil = (notice.validUntil || '').replace(/"/g, '&quot;');
            const safeDescription = (notice.description || '').replace(/"/g, '&quot;');
            const category = notice.category || 'general';
            // Format dates for display
            const displayDate = safeDate ? new Date(safeDate).toLocaleDateString('en-US', { 
              year: 'numeric', month: 'long', day: 'numeric' 
            }) : '';
            const displayValidUntil = safeValidUntil ? new Date(safeValidUntil).toLocaleDateString('en-US', { 
              year: 'numeric', month: 'long', day: 'numeric' 
            }) : '';
            // Use category-specific badge class for color control
            let safeCategory = category;
            if (!['urgent', 'academic', 'events', 'general'].includes(category)) {
              safeCategory = 'general';
            }
            const badgeClass = safeCategory === 'general' ? 'notice-badge-general' : `notice-badge-${safeCategory}`;
            const badgeIconMap = {
              urgent: 'fas fa-exclamation-triangle',
              academic: 'fas fa-graduation-cap',
              events: 'fas fa-calendar-alt',
              general: 'fas fa-info-circle'
            };
            const badgeTextMap = {
              urgent: 'Urgent',
              academic: 'Academic',
              events: 'Event',
              general: 'General'
            };
            const badgeIcon = badgeIconMap[safeCategory] || badgeIconMap.general;
            const badgeText = badgeTextMap[safeCategory] || badgeTextMap.general;

            // Truncation logic
            const titleTruncated = notice.title.length > maxTitleLength;
            const descriptionTruncated = notice.description.length > maxDescriptionLength;
            const showReadMore = titleTruncated || descriptionTruncated;
            const displayTitle = titleTruncated ? notice.title.substring(0, maxTitleLength) + '...' : notice.title;
            const displayDescription = descriptionTruncated ? notice.description.substring(0, maxDescriptionLength) + '...' : notice.description;
            // Unique id for expand/collapse
            const noticeId = `main-notice-${idx}`;
            return `
            <li class="notice-item ${safeCategory}" data-category="${safeCategory}" data-notice-id="${noticeId}" data-expanded="false">
              <div class="main-notice-pin" aria-hidden="true" style="margin: 0 auto 0.3rem auto;"></div>
              <div class="notice-badge ${badgeClass}">
                <i class="${badgeIcon}"></i> ${badgeText}
              </div>
              <div class="notice-content">
                <h3 class="main-notice-title" data-full-title="${safeTitle}">${displayTitle}</h3>
                <div class="notice-meta">
                  <span class="notice-date">
                    <i class="fas fa-calendar"></i> Posted: ${displayDate}
                  </span>
                  ${displayValidUntil ? `
                  <span class="notice-valid">
                    <i class="fas fa-clock"></i> Valid until: ${displayValidUntil}
                  </span>
                  ` : ''}
                </div>
                <p class="main-notice-description" data-full-description="${safeDescription}">${displayDescription}</p>
                ${showReadMore ? `
                  <div class="main-notice-action">
                    <button class="main-notice-read-more-btn" style="display:inline-flex;">
                      <span>Read more</span>
                      <svg width="12" height="12" viewBox="0 0 24 24" fill="none">
                        <path d="M7 17L17 7M17 7H7M17 7V17" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                      </svg>
                    </button>
                    <button class="main-notice-read-less-btn" style="display:none;">
                      <span>Read less</span>
                      <svg width="12" height="12" viewBox="0 0 24 24" fill="none">
                        <path d="M17 7L7 17M7 17H17M7 17V7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                      </svg>
                    </button>
                  </div>
                ` : ''}
              </div>
            </li>
          `;
          }).join('');

          // Add expand/collapse logic for main notice board
          setTimeout(() => {
            const noticeItems = noticesList.querySelectorAll('.notice-item[data-notice-id]');
            noticeItems.forEach(noticeItem => {
              const readMoreBtn = noticeItem.querySelector('.main-notice-read-more-btn');
              const readLessBtn = noticeItem.querySelector('.main-notice-read-less-btn');
              const titleEl = noticeItem.querySelector('.main-notice-title');
              const descEl = noticeItem.querySelector('.main-notice-description');
              if (readMoreBtn) {
                readMoreBtn.addEventListener('click', function(e) {
                  e.preventDefault();
                  // Expand to full
                  titleEl.textContent = titleEl.dataset.fullTitle;
                  descEl.textContent = descEl.dataset.fullDescription;
                  noticeItem.classList.add('expanded');
                  noticeItem.dataset.expanded = 'true';
                  // Remove any max-height/height restrictions and force reflow
                  noticeItem.style.maxHeight = 'none';
                  noticeItem.style.height = 'auto';
                  noticeItem.style.minHeight = 'unset';
                  noticeItem.style.overflow = 'visible';
                  // Force a reflow to ensure the browser recalculates layout
                  noticeItem.offsetHeight;
                  // Optionally, scroll into view if needed
                  // noticeItem.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
                  readMoreBtn.style.display = 'none';
                  if (readLessBtn) readLessBtn.style.display = 'inline-flex';
                });
              }
              if (readLessBtn) {
                readLessBtn.addEventListener('click', function(e) {
                  e.preventDefault();
                  // Collapse to truncated
                  const fullTitle = titleEl.dataset.fullTitle;
                  const fullDesc = descEl.dataset.fullDescription;
                  const maxTitleLength = 80;
                  const maxDescriptionLength = 120;
                  const newTitle = fullTitle.length > maxTitleLength ? fullTitle.substring(0, maxTitleLength) + '...' : fullTitle;
                  const newDesc = fullDesc.length > maxDescriptionLength ? fullDesc.substring(0, maxDescriptionLength) + '...' : fullDesc;
                  titleEl.textContent = newTitle;
                  descEl.textContent = newDesc;
                  noticeItem.classList.remove('expanded');
                  noticeItem.dataset.expanded = 'false';
                  // Remove forced height/overflow/minHeight/maxHeight
                  noticeItem.style.height = '';
                  noticeItem.style.overflow = '';
                  noticeItem.style.minHeight = '';
                  noticeItem.style.maxHeight = '';
                  readLessBtn.style.display = 'none';
                  if (readMoreBtn) readMoreBtn.style.display = 'inline-flex';
                });
              }
            });
            // Re-initialize notice board filtering after updating content
            if (window.initializeNoticeBoard) {
              window.initializeNoticeBoard();
            }
          }, 100);
        }
      }
      
      function updateFaqSection(faqData) {
        const faqList = document.querySelector('.faq-list');
        if (faqList && faqData.length > 0) {
          // Sort FAQ data by order field
          const sortedFaqData = faqData.sort((a, b) => (a.order || 0) - (b.order || 0));
          
          faqList.innerHTML = sortedFaqData.map((faq, index) => {
            const safeQuestion = (faq.question || '').replace(/"/g, '&quot;');
            const safeAnswer = (faq.answer || '').replace(/"/g, '&quot;');
            const faqId = `faq${index + 1}`;
            const btnId = `${faqId}-btn`;
            
            return `
            <li class="faq-item">
              <button class="faq-question" aria-expanded="false" aria-controls="${faqId}" id="${btnId}">
                ${safeQuestion}
              </button>
              <div class="faq-answer" id="${faqId}" role="region" aria-labelledby="${btnId}">
                ${safeAnswer}
              </div>
            </li>
          `;
          }).join('');
          
          // Reinitialize FAQ event listeners for dynamically loaded content
          initializeFaqEventListeners();
        }
      }
      
      function initializeFaqEventListeners() {
        const faqButtons = document.querySelectorAll(".faq-question");
        faqButtons.forEach((btn) => {
          // Remove existing event listeners to avoid duplicates
          btn.replaceWith(btn.cloneNode(true));
        });
        
        // Re-query after cloning
        const newFaqButtons = document.querySelectorAll(".faq-question");
        newFaqButtons.forEach((btn) => {
          btn.addEventListener("click", () => {
            const expanded = btn.getAttribute("aria-expanded") === "true";
            // Collapse all others
            newFaqButtons.forEach((otherBtn) => {
              if (otherBtn !== btn) {
                otherBtn.setAttribute("aria-expanded", "false");
                otherBtn.parentElement.classList.remove("open");
              }
            });
            // Toggle current
            btn.setAttribute("aria-expanded", String(!expanded));
            btn.parentElement.classList.toggle("open", !expanded);
          });
        });
      }
      
      function updateAcademicsSection(academicsData) {
        const academicsSection = document.getElementById('academics');
        if (academicsSection && academicsData) {
          // Update description
          const descriptionP = academicsSection.querySelector('p');
          if (descriptionP && academicsData.description) {
            descriptionP.textContent = academicsData.description;
          }
          
          // Update the list items
          const list = academicsSection.querySelector('ul');
          if (list) {
            list.innerHTML = `
              <li><strong>Curriculum:</strong> ${academicsData.curriculum || 'CBSE syllabus from Nursery to Class XII.'}</li>
              <li><strong>Special Programs:</strong> ${academicsData.programs || 'STEM initiatives, Coding clubs, Language enrichment.'}</li>
              <li><strong>Assessment:</strong> ${academicsData.assessment || 'Continuous Evaluation, Project Based Learning, Olympiads preparation.'}</li>
              <li><strong>Extra-Curricular:</strong> ${academicsData.extracurricular || 'Art, Music, Dance, Debate, and Sports to nurture talents.'}</li>
            `;
          }
        }
      }
      
      function updateLogoSection(logoData) {
        if (logoData) {
          // Update logo image
          const logoImg = document.querySelector('.logo-img');
          if (logoImg && logoData.logoUrl) {
            logoImg.src = logoData.logoUrl;
            logoImg.alt = `${logoData.schoolName || 'School'} Logo`;
          }
          
          // Update school name
          const schoolName = document.querySelector('.school-name');
          if (schoolName && logoData.schoolName) {
            schoolName.textContent = logoData.schoolName;
          }
          
          // Update tagline
          const tagline = document.querySelector('.school-tagline');
          if (tagline && logoData.tagline) {
            tagline.textContent = logoData.tagline;
          }
        }
      }
      
      // Helper function to clear cache for testing (call from browser console)
      window.clearDynamicContentCache = function() {
        localStorage.removeItem('facultyData');
        localStorage.removeItem('facultyCacheTime');
        localStorage.removeItem('testimonialsData');
        localStorage.removeItem('testimonialsCacheTime');
        localStorage.removeItem('galleryData');
        localStorage.removeItem('galleryCacheTime');
        localStorage.removeItem('eventsData');
        localStorage.removeItem('eventsCacheTime');
        localStorage.removeItem('heroData');
        localStorage.removeItem('heroCacheTime');
        localStorage.removeItem('aboutData');
        localStorage.removeItem('aboutCacheTime');
        localStorage.removeItem('academicsData');
        localStorage.removeItem('academicsCacheTime');
        localStorage.removeItem('logoData');
        localStorage.removeItem('logoCacheTime');
        localStorage.removeItem('school-infoData');
        localStorage.removeItem('school-infoCacheTime');
        localStorage.removeItem('contactData');
        localStorage.removeItem('contactCacheTime');
        localStorage.removeItem('faqData');
        localStorage.removeItem('faqCacheTime');
        console.log('All cache cleared! Reload the page to see fresh data.');
      };

      // Notice Ticker Bar & Panel Functionality
      window.noticeState = {
        panelOpen: false,
        notices: [],
        isLoaded: false
      };

      function toggleNoticePanel() {
        const panel = document.getElementById('notice-panel');
        
        window.noticeState.panelOpen = !window.noticeState.panelOpen;
        
        if (window.noticeState.panelOpen) {
          panel.classList.add('open');
          
          // Load notices if not already loaded
          if (!window.noticeState.isLoaded) {
            loadNoticesData();
          }
        } else {
          panel.classList.remove('open');
        }
      }

      async function loadNoticesData() {
        try {
          window.noticeState.isLoaded = true;
          
          // Use the same Firebase data that the main page uses
          const cachedEventsData = localStorage.getItem('eventsData');
          const cachedTime = localStorage.getItem('eventsCacheTime');
          const now = Date.now();
          const CACHE_DURATION = 10 * 60 * 1000; // 10 minutes cache
          
          let eventsData = [];
          
          if (cachedEventsData && cachedTime && (now - parseInt(cachedTime)) < CACHE_DURATION) {
            eventsData = JSON.parse(cachedEventsData);
          } else if (typeof firebase !== 'undefined' && firebase.firestore) {
            try {
              const db = firebase.firestore();
              const snapshot = await db.collection('events').orderBy('date', 'desc').limit(20).get();
              eventsData = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
              
              // Cache the data
              localStorage.setItem('eventsData', JSON.stringify(eventsData));
              localStorage.setItem('eventsCacheTime', now.toString());
            } catch (error) {
              console.warn('Firebase error for notices, using sample data:', error);
              eventsData = getSampleNoticesData();
            }
          } else {
            eventsData = getSampleNoticesData();
          }
          
          // Filter and sort notices (show only recent and active ones)
          const today = new Date();
          today.setHours(0, 0, 0, 0); // Set to start of day for proper comparison
          console.log('Today\'s date (start of day):', today.toISOString());
          
          const activeNotices = eventsData.filter(notice => {
            if (notice.validUntil && notice.validUntil.trim() !== '') {
              const validUntilDate = new Date(notice.validUntil);
              validUntilDate.setHours(23, 59, 59, 999); // Set to end of day
              const isValid = validUntilDate >= today;
              console.log(`Notice "${notice.title}": validUntil=${notice.validUntil}, parsed date=${validUntilDate.toISOString()}, isValid=${isValid}`);
              return isValid;
            }
            console.log(`Notice "${notice.title}": no validUntil or empty, including`);
            return true;
          });
          
          console.log(`Total notices: ${eventsData.length}, Active notices: ${activeNotices.length}`);
          console.log('Active notices:', activeNotices.map(n => n.title));
          
          window.noticeState.notices = activeNotices;
          updateNoticeTicker(activeNotices);
          renderNoticePanel(activeNotices);
          
        } catch (error) {
          console.error('Error loading notices:', error);
          const tickerText = document.getElementById('notice-ticker-text');
          tickerText.innerHTML = '<span class="ticker-item">📌 Error loading notices</span>';
        }
      }

      function getSampleNoticesData() {
        return [
          {
            id: '1',
            title: 'Mid-term Examination Schedule Released',
            date: '2025-07-27',
            validUntil: '2025-09-30',
            category: 'urgent',
            description: 'Mid-term examinations for all classes will commence from September 15, 2025. Students must prepare according to the detailed schedule available in the admissions section.'
          },
          {
            id: '2',
            title: 'Annual Sports Day - August 15, 2025',
            date: '2025-07-25',
            validUntil: '',
            category: 'events',
            description: 'Join us for a day full of sportsmanship and fun activities for all students. Participation forms available at the sports department.'
          },
          {
            id: '3',
            title: 'Science Exhibition - September 10, 2025',
            date: '2025-07-20',
            validUntil: '',
            category: 'academic',
            description: 'A platform for young innovators to showcase their projects and experiments. Registration deadline: August 25, 2025.'
          },
          {
            id: '4',
            title: 'Parent-Teacher Meeting - October 5, 2025',
            date: '2025-07-18',
            validUntil: '',
            category: 'general',
            description: 'Discuss your child\'s progress and participate in school development feedback sessions. Meeting timings: 9 AM to 4 PM.'
          },
          {
            id: '5',
            title: 'Holiday Notice - Independence Day',
            date: '2025-07-27',
            validUntil: '2025-08-15',
            category: 'urgent',
            description: 'School will remain closed on August 15, 2025, in observance of Independence Day. Regular classes will resume on August 16, 2025.'
          }
        ];
      }

      function updateNoticeTicker(notices) {
        const tickerText = document.getElementById('notice-ticker-text');
        const countBadge = document.getElementById('notice-count-badge');
        
        console.log(`updateNoticeTicker called with ${notices.length} notices`);
        console.log('countBadge element:', countBadge);
        
        if (!countBadge) {
          console.error('notice-count-badge element not found!');
          return;
        }
        
        if (notices.length === 0) {
          tickerText.innerHTML = '<span class="ticker-item">📌 No active notices at this time</span>';
          countBadge.textContent = '0';
          countBadge.classList.remove('show');
          console.log('Set badge to 0, removed show class');
          return;
        }
        
        // Update count badge
        countBadge.textContent = notices.length;
        countBadge.classList.add('show');
        console.log(`Set badge count to: ${notices.length}, added show class`);
        console.log('Badge classes:', countBadge.classList.toString());
        
        // Create ticker items
        const tickerItems = notices.map(notice => {
          const categoryIcon = getCategoryIcon(notice.category);
          const urgentClass = notice.category === 'urgent' ? ' urgent' : '';
          return `<span class="ticker-item${urgentClass}">${categoryIcon} ${notice.title}</span>`;
        }).join('');
        
        tickerText.innerHTML = tickerItems;
      }

      function renderNoticePanel(notices) {
        const content = document.getElementById('notice-panel-content');
        
        if (notices.length === 0) {
          content.innerHTML = '<div class="notice-loading">No active notices at this time</div>';
          return;
        }
        
        const noticesHtml = notices.map(notice => {
          const formattedDate = formatNoticeDate(notice.date);
          const categoryIcon = getCategoryIcon(notice.category);
          
          // Create truncated versions for display
          const maxTitleLength = 80;
          const maxDescriptionLength = 120;
          
          const titleTruncated = notice.title.length > maxTitleLength;
          const descriptionTruncated = notice.description.length > maxDescriptionLength;
          const showReadMore = titleTruncated || descriptionTruncated;
          
          const displayTitle = titleTruncated ? notice.title.substring(0, maxTitleLength) + '...' : notice.title;
          const displayDescription = descriptionTruncated ? notice.description.substring(0, maxDescriptionLength) + '...' : notice.description;
          
          return `
            <div class="notice-item-panel ${notice.category}" data-notice-id="${notice.id}" data-expanded="false">
              <div class="notice-item-header">
                <span class="notice-category ${notice.category}">${categoryIcon} ${notice.category}</span>
                <span class="notice-date">${formattedDate}</span>
              </div>
              <div class="notice-title" data-full-title="${notice.title.replace(/"/g, '&quot;')}">${displayTitle}</div>
              <div class="notice-description" data-full-description="${notice.description.replace(/"/g, '&quot;')}">${displayDescription}</div>
              ${showReadMore ? `
                <div class="notice-action">
                  <button class="notice-read-more-btn">
                    <span>Read more</span>
                    <svg width="12" height="12" viewBox="0 0 24 24" fill="none">
                      <path d="M7 17L17 7M17 7H7M17 7V17" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                  </button>
                  <button class="notice-read-less-btn" style="display: none;">
                    <span>Read less</span>
                    <svg width="12" height="12" viewBox="0 0 24 24" fill="none">
                      <path d="M17 7L7 17M7 17H17M7 17V7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                  </button>
                </div>
              ` : ''}
            </div>
          `;
        }).join('');
        
        content.innerHTML = noticesHtml;
        
        // Add click event listeners to notice items in panel (different class than main notices)
        const noticeItems = content.querySelectorAll('.notice-item-panel[data-notice-id]');
        console.log('Found notice items in panel:', noticeItems.length);
        
        // Add click event handlers for expansion only
        content.addEventListener('click', function(e) {
          // Check if clicked on read more or read less button (only if visible)
          const readMoreBtn = e.target.closest('.notice-read-more-btn');
          const readLessBtn = e.target.closest('.notice-read-less-btn');
          // Only respond to clicks on visible buttons
          if (readMoreBtn && readMoreBtn.style.display !== 'none') {
            e.stopPropagation();
            e.preventDefault();
            const noticeItem = readMoreBtn.closest('.notice-item-panel');
            if (noticeItem) {
              window.toggleNoticeExpansion(noticeItem);
            }
            return;
          }
          if (readLessBtn && readLessBtn.style.display !== 'none') {
            e.stopPropagation();
            e.preventDefault();
            const noticeItem = readLessBtn.closest('.notice-item-panel');
            if (noticeItem) {
              window.toggleNoticeExpansion(noticeItem);
            }
            return;
          }
          // No modal opening - cards only expand/collapse
          // Users can read full content by clicking "Read more"
        });
      }

      // Function to toggle notice expansion - moved outside renderNoticePanel
      window.toggleNoticeExpansion = function(noticeItem) {
        const titleEl = noticeItem.querySelector('.notice-title');
        const descriptionEl = noticeItem.querySelector('.notice-description');
        const readMoreBtn = noticeItem.querySelector('.notice-read-more-btn');
        const readLessBtn = noticeItem.querySelector('.notice-read-less-btn');
        
        // Check if currently showing full content by comparing with stored full content
        const currentTitle = titleEl.textContent;
        const currentDescription = descriptionEl.textContent;
        const fullTitle = titleEl.dataset.fullTitle;
        const fullDescription = descriptionEl.dataset.fullDescription;
        
        const isCurrentlyExpanded = (currentTitle === fullTitle && currentDescription === fullDescription);
        
        console.log('Current state check:');
        console.log('Current title:', currentTitle);
        console.log('Full title:', fullTitle);
        console.log('Current description:', currentDescription);
        console.log('Full description:', fullDescription);
        console.log('Is currently expanded:', isCurrentlyExpanded);
        
        if (isCurrentlyExpanded) {
          // Currently showing full content - collapse to truncated
          const maxTitleLength = 80;
          const maxDescriptionLength = 120;
          
          const titleTruncated = fullTitle.length > maxTitleLength;
          const descriptionTruncated = fullDescription.length > maxDescriptionLength;
          
          const newTitle = titleTruncated ? fullTitle.substring(0, maxTitleLength) + '...' : fullTitle;
          const newDescription = descriptionTruncated ? fullDescription.substring(0, maxDescriptionLength) + '...' : fullDescription;
          
          console.log('Setting new title:', newTitle);
          console.log('Setting new description:', newDescription);
          
          titleEl.textContent = newTitle;
          descriptionEl.textContent = newDescription;
          
          // Force a reflow to ensure DOM updates
          titleEl.offsetHeight;
          descriptionEl.offsetHeight;
          
          noticeItem.classList.remove('expanded');
          noticeItem.dataset.expanded = 'false';
          if (readMoreBtn) {
            readMoreBtn.style.display = 'inline-flex';
            console.log('Showing read more button');
          }
          if (readLessBtn) {
            readLessBtn.style.display = 'none';
            console.log('Hiding read less button');
          }
          
          console.log('After update - Title:', titleEl.textContent);
          console.log('After update - Description:', descriptionEl.textContent);
          console.log('Collapsed to truncated view');
        } else {
          // Currently showing truncated content - expand to full
          console.log('Setting full title:', fullTitle);
          console.log('Setting full description:', fullDescription);
          
          titleEl.textContent = fullTitle;
          descriptionEl.textContent = fullDescription;
          
          // Force a reflow to ensure DOM updates
          titleEl.offsetHeight;
          descriptionEl.offsetHeight;
          
          noticeItem.classList.add('expanded');
          noticeItem.dataset.expanded = 'true';
          if (readMoreBtn) {
            readMoreBtn.style.display = 'none';
            console.log('Hiding read more button');
          }
          if (readLessBtn) {
            readLessBtn.style.display = 'inline-flex';
            console.log('Showing read less button');
          }
          
          console.log('After update - Title:', titleEl.textContent);
          console.log('After update - Description:', descriptionEl.textContent);
          console.log('Expanded to full view');
        }
      }

      function getCategoryIcon(category) {
        const icons = {
          urgent: '🚨',
          academic: '📚',
          events: '🎉',
          general: '📋'
        };
        return icons[category] || '📌';
      }

      function formatNoticeDate(dateString) {
        try {
          const date = new Date(dateString);
          return date.toLocaleDateString('en-US', {
            year: 'numeric',
            month: 'short',
            day: 'numeric'
          });
        } catch (error) {
          return dateString;
        }
      }

      // Show notice details in modal
      function showNoticeDetails(noticeId) {
        console.log('showNoticeDetails called with:', noticeId);
        console.log('Available notices:', window.noticeState.notices);
        
        const notice = window.noticeState.notices.find(n => n.id === noticeId);
        if (!notice) {
          console.log('Notice not found:', noticeId);
          return;
        }

        console.log('Found notice:', notice);
        const modal = document.getElementById('notice-modal');
        const modalBody = document.getElementById('notice-modal-body');
        const modalTitle = document.getElementById('notice-modal-title');

        if (!modal || !modalBody || !modalTitle) {
          console.log('Modal elements not found');
          return;
        }

        modalTitle.textContent = 'Notice Details';

        const categoryIcon = getCategoryIcon(notice.category);
        const formattedDate = formatNoticeDate(notice.date);
        
        modalBody.innerHTML = `
          <div class="notice-modal-category ${notice.category}">${categoryIcon} ${notice.category}</div>
          <div class="notice-modal-date">📅 ${formattedDate}</div>
          <div class="notice-modal-title">${notice.title}</div>
          <div class="notice-modal-description">${notice.description}</div>
          ${notice.validUntil ? `<div style="margin-top: 1rem; padding: 1rem; background: var(--border-light); border-radius: 8px; font-size: 0.9rem; color: var(--text-secondary);">
            <strong>📍 Valid Until:</strong> ${formatNoticeDate(notice.validUntil)}
          </div>` : ''}
        `;

        modal.classList.add('show');
        document.body.style.overflow = 'hidden';
        console.log('Modal should be visible now');
      }

      // Close notice modal
      function closeNoticeModal() {
        const modal = document.getElementById('notice-modal');
        modal.classList.remove('show');
        document.body.style.overflow = '';
      }

      // Navigate to notice board section
      function goToNoticeBoard() {
        closeNoticeModal();
        toggleNoticePanel(); // Close notice panel if open
        
        // Scroll to events section (which contains the notice board)
        const noticesSection = document.getElementById('events');
        if (noticesSection) {
          noticesSection.scrollIntoView({ behavior: 'smooth' });
          
          // Update active navigation
          setTimeout(() => {
            updateActiveNavigation('events');
          }, 500);
        }
      }

      // Close panel when clicking outside
      document.addEventListener('click', function(event) {
        const panel = document.getElementById('notice-panel');
        const bellIcon = document.querySelector('.notice-bell-icon');
        const viewAllBtn = document.querySelector('.notice-view-all');
        
        if (window.noticeState.panelOpen && 
            !panel.contains(event.target) && 
            !bellIcon.contains(event.target) &&
            !viewAllBtn.contains(event.target)) {
          toggleNoticePanel();
        }

        // Close notice modal when clicking outside
        const modal = document.getElementById('notice-modal');
        const modalContent = document.querySelector('.notice-modal-content');
        
        if (modal && modal.classList.contains('show') && 
            modalContent && !modalContent.contains(event.target)) {
          closeNoticeModal();
        }
      });

      // Close modal with Escape key
      document.addEventListener('keydown', function(event) {
        if (event.key === 'Escape') {
          const modal = document.getElementById('notice-modal');
          if (modal && modal.classList.contains('show')) {
            closeNoticeModal();
          }
        }
      });

      // Initialize notice system on page load
      function initializeNoticeSystem() {
        // Check if DOM elements exist before loading
        const tickerBar = document.getElementById('notice-ticker-bar');
        const countBadge = document.getElementById('notice-count-badge');
        
        if (!tickerBar || !countBadge) {
          console.warn('Notice system DOM elements not ready, retrying in 100ms');
          setTimeout(initializeNoticeSystem, 100);
          return;
        }
        
        // Calculate and set header height for sticky positioning
        adjustNoticeTickerPosition();
        
        console.log('Notice system initializing - DOM elements found');
        loadNoticesData();
      }

      // Function to adjust notice ticker position based on header height
      function adjustNoticeTickerPosition() {
        const header = document.querySelector('header');
        const tickerBar = document.getElementById('notice-ticker-bar');
        
        if (header && tickerBar) {
          const headerHeight = header.offsetHeight;
          console.log('Calculated header height:', headerHeight + 'px');
          
          // Set CSS custom property for header height
          document.documentElement.style.setProperty('--calculated-header-height', headerHeight + 'px');
          
          // Apply the calculated height to the ticker bar (directly below header)
          tickerBar.style.top = headerHeight + 'px';
        }
      }

      // Recalculate on window resize
      window.addEventListener('resize', adjustNoticeTickerPosition);

      // Initialize notice system when page loads
      setTimeout(() => {
        initializeNoticeSystem();
      }, 1000);

      // Make toggle function globally available
      window.toggleNoticePanel = toggleNoticePanel;
    });
  </script>

  <!-- Floating Refresh Button -->
  <button 
    id="refresh-fab" 
    class="refresh-fab"
    title="Refresh content (Ctrl+Shift+R)"
    aria-label="Refresh content"
    tabindex="0"
    style="position: fixed; bottom: 74px; right: 32px; z-index: 10001; width: 40px; height: 40px; padding: 0; border-radius: 50%; display: flex; align-items: center; justify-content: center;"
  >
    <i class="fas fa-sync-alt" aria-hidden="true" style="font-size: 18px;"></i>
  </button>
  <script>
    function showRefreshNotification() {
      var notification = document.createElement('div');
      notification.style.cssText = "position:fixed;top:20px;right:20px;background:#10b981;color:white;padding:12px 20px;border-radius:8px;box-shadow:0 4px 12px rgba(0,0,0,0.1);z-index:10000;font-family:inherit;font-size:14px;opacity:0;transform:translateX(100%);transition:all 0.3s ease;";
      notification.textContent = 'Content refreshed successfully!';
      document.body.appendChild(notification);
      setTimeout(function() {
        notification.style.opacity = '1';
        notification.style.transform = 'translateX(0)';
      }, 100);
      setTimeout(function() {
        notification.style.opacity = '0';
        notification.style.transform = 'translateX(100%)';
        setTimeout(function() {
          if (notification.parentNode) notification.parentNode.removeChild(notification);
        }, 300);
      }, 3000);
    }

    document.getElementById('refresh-fab').addEventListener('click', function() {
      let refreshed = false;
      if (typeof forceRefreshContent === 'function') {
        try {
          forceRefreshContent();
          refreshed = true;
        } catch (e) {
          refreshed = false;
        }
      }
      if (!refreshed) {
        // fallback: reload page, but set flag for notification
        localStorage.setItem('showRefreshNotification', '1');
        location.reload();
      } else {
        // show notification if not already shown
        if (typeof showUpdateNotification === 'function') {
          showUpdateNotification('Content refreshed successfully!');
        } else {
          showRefreshNotification();
        }
      }
    });

    // Show notification after reload if flag is set
    if (localStorage.getItem('showRefreshNotification') === '1') {
      localStorage.removeItem('showRefreshNotification');
      showRefreshNotification();
    }
  </script>

  <!-- Back to Top Button -->
  <button 
    id="back-to-top" 
    class="back-to-top"
    onclick="scrollToTop()" 
    title="Back to top"
    style="position: fixed; bottom: 32px; right: 32px; z-index: 10001; width: 40px; height: 40px; padding: 0; border-radius: 50%; display: flex; align-items: center; justify-content: center;"
  >
    <i class="fas fa-arrow-up" aria-hidden="true" style="font-size: 18px;"></i>
  </button>

</body>
</html>
