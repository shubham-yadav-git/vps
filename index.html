<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Vikas Public School</title>
  <!-- Favicon -->
  <link rel="icon" type="image/svg+xml" href="assets/favicon.svg">
  <link rel="alternate icon" href="assets/favicon.svg">
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:wght@400;600;700&display=swap"
    rel="stylesheet"
  />
  <link rel="stylesheet" href="css/style.css" />
  <style>
    /* Modern Global Styles */
    :root {
      --primary-color: #4f46e5;
      --primary-dark: #3730a3;
      --primary-light: #e0e7ff;
      --secondary-color: #059669;
      --accent-color: #dc2626;
      --background: #fefefe;
      --surface: #fdfdfd;
      --surface-elevated: #ffffff;
      --text-primary: #1e293b;
      --text-secondary: #64748b;
      --text-muted: #94a3b8;
      --border: #e2e8f0;
      --border-light: #f1f5f9;
      --gradient-primary: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
      --gradient-secondary: linear-gradient(135deg, #059669 0%, #047857 100%);
      --gradient-accent: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%);
      --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
      --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
      --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
      --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);
      --border-radius: 12px;
      --border-radius-lg: 16px;
      --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      line-height: 1.6;
      color: var(--text-primary);
      background: var(--background);
      overflow-x: hidden;
    }

    /* Modern Header */
    header {
      position: sticky;
      top: 0;
      z-index: 1000;
      background: rgba(254, 254, 254, 0.95);
      backdrop-filter: blur(20px);
      border-bottom: 1px solid var(--border-light);
      transition: var(--transition);
    }

    /* Smooth scroll behavior */
    html {
      scroll-behavior: smooth;
    }

    /* Modern typography */
    h1, h2, h3, h4, h5, h6 {
      font-family: 'Playfair Display', serif;
      font-weight: 600;
      line-height: 1.2;
      color: var(--text-primary);
    }

    /* Glass morphism effect for cards */
    .glass {
      background: rgba(255, 255, 255, 0.25);
      backdrop-filter: blur(20px);
      border: 1px solid rgba(255, 255, 255, 0.18);
      box-shadow: var(--shadow-xl);
    }

    /* Modern button styles */
    .btn-modern {
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.75rem 1.5rem;
      background: var(--gradient-primary);
      color: white;
      text-decoration: none;
      border-radius: var(--border-radius);
      font-weight: 500;
      transition: var(--transition);
      border: none;
      cursor: pointer;
      box-shadow: var(--shadow-md);
    }

    .btn-modern:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-lg);
    }

    /* Loading animations */
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes slideInRight {
      from {
        opacity: 0;
        transform: translateX(30px);
      }
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }

    /* Intersection Observer animations */
    .animate-on-scroll {
      opacity: 0;
      transform: translateY(30px);
      transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .animate-on-scroll.visible {
      opacity: 1;
      transform: translateY(0);
    }
  </style>
  <!-- Include fontawesome icons for social -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  
  <!-- Firebase SDKs - Free Tier Optimized -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
</head>
<body>
  <!-- Reading Progress Bar -->
  <div id="reading-progress" style="
    position: fixed;
    top: 0;
    left: 0;
    width: 0%;
    height: 3px;
    background: var(--primary-color);
    z-index: 9999;
    transition: width 0.3s ease;
  "></div>
  
  <header>
    <div class="header-container">
      <div class="logo-section">
        <img
          src="assets/logo.png"
          alt="Vikas Public School Logo"
          class="logo-img"
          aria-hidden="false"
          aria-label="School Logo"
        />
        <div class="logo-text">
          <h1 class="school-name">Vikas Public School</h1>
          <p class="school-tagline">Excellence in Education</p>
        </div>
      </div>
      
      <nav class="main-nav" aria-label="Primary navigation" id="main-nav">
        <ul class="nav-menu">
          <li><a href="#hero" class="nav-link">Home</a></li>
          <li><a href="#about" class="nav-link">About</a></li>
          <li><a href="#academics" class="nav-link">Academics</a></li>
          <li><a href="#faculty" class="nav-link">Faculty</a></li>
          <li><a href="#events" class="nav-link">Events</a></li>
          <li><a href="#gallery" class="nav-link">Gallery</a></li>
          <li><a href="#testimonials" class="nav-link">Testimonials</a></li>
          <li><a href="#faq" class="nav-link">FAQ</a></li>
          <li><a href="#admissions" class="nav-link">Admissions</a></li>
          <li><a href="#contact" class="nav-link">Contact</a></li>
        </ul>
      </nav>
      
      <div class="header-actions">
        <button
          class="hamburger"
          aria-label="Toggle navigation menu"
          aria-expanded="false"
          onclick="toggleMenu()"
          onkeypress="event.key === 'Enter' && toggleMenu()"
        >
          <span></span>
          <span></span>
          <span></span>
        </button>
      </div>
    </div>
  </header>

  <div class="hero" id="hero" role="banner" aria-label="Welcome message">
    Excellence in Education, Empowering Future Leaders
  </div>

  <main>
    <section class="section" id="about" tabindex="-1">
      <div class="about-container">
        <div class="about-header">
          <h2>About Us</h2>
          <p class="about-intro">
            Vikas Public School, established in 2004, is committed to nurturing young minds through
            holistic education. Our mission is to foster intellectual curiosity, critical thinking,
            and responsible citizenship through a dynamic curriculum and dedicated faculty.
          </p>
        </div>

        <div class="about-content">
          <!-- Leadership Section -->
          <div class="leadership-section">
            <h3>Our Leadership</h3>
            <div class="leadership-grid">
              <div class="profile-card manager-profile">
                <div class="profile-image">
                  <img src="assets/IMG-20250726-WA0016.jpg" alt="Jatashankar Pal, Manager" />
                </div>
                <div class="profile-info">
                  <h4>Jatashankar Pal</h4>
                  <p class="position">Manager</p>
                  <p class="description">Leading the institution with vision and dedication to excellence in education.</p>
                </div>
              </div>
              
              <div class="profile-card principal-profile">
                <div class="profile-image">
                  <img src="assets/IMG-20250726-WA0017.jpg" alt="Principal" />
                </div>
                <div class="profile-info">
                  <h4>Principal</h4>
                  <p class="position">Principal</p>
                  <p class="description">Committed to fostering academic excellence and character development.</p>
                </div>
              </div>
            </div>
          </div>

          <!-- Highlights Section -->
          <div class="highlights-section">
            <h3>What Makes Us Special</h3>
            <div class="highlights-grid">
              <div class="highlight-card">
                <div class="highlight-icon">üèõÔ∏è</div>
                <h4>CBSE Affiliation</h4>
                <p>Accredited standards ensuring quality education</p>
              </div>
              
              <div class="highlight-card">
                <div class="highlight-icon">üè´</div>
                <h4>Modern Campus</h4>
                <p>Smart classrooms, libraries, science labs, and sports facilities</p>
              </div>
              
              <div class="highlight-card">
                <div class="highlight-icon">üéØ</div>
                <h4>Holistic Development</h4>
                <p>Focus on academics, co-curricular activities, and personal growth</p>
              </div>
              
              <div class="highlight-card">
                <div class="highlight-icon">üõ°Ô∏è</div>
                <h4>Safe Environment</h4>
                <p>Inclusive and secure learning atmosphere for all students</p>
              </div>
            </div>
          </div>

          <!-- Call to Action -->
          <div class="about-actions">
            <a href="#admissions" class="cta-button primary">Explore Admissions</a>
            <a href="#contact" class="cta-button secondary">Contact Us</a>
          </div>
        </div>
      </div>
    </section>

    <section class="section" id="academics" tabindex="-1" aria-labelledby="academics-heading">
      <h2 id="academics-heading">Academics</h2>
      <p>
        At Vikas Public School, we offer a comprehensive curriculum that nurtures academic excellence and critical thinking skills.
      </p>
      <ul>
        <li><strong>Curriculum:</strong> CBSE syllabus from Nursery to Class XII.</li>
        <li><strong>Special Programs:</strong> STEM initiatives, Coding clubs, Language enrichment.</li>
        <li><strong>Assessment:</strong> Continuous Evaluation, Project Based Learning, Olympiads preparation.</li>
        <li><strong>Extra-Curricular:</strong> Art, Music, Dance, Debate, and Sports to nurture talents.</li>
      </ul>
    </section>

    <section class="section" id="faculty" tabindex="-1" aria-labelledby="faculty-heading">
      <h2 id="faculty-heading">Our Faculty</h2>
      <ul class="faculty-list" aria-live="polite">
        <li class="faculty-member">
          <img src="assets/faculty1.jpg" alt="Ms. Priya Sharma" class="faculty-photo" />
          <div class="faculty-info">
            <h3>Ms. Priya Sharma</h3>
            <p>Head of Science Department - 15 years of teaching experience and passion for student mentoring.</p>
          </div>
        </li>
        <li class="faculty-member">
          <img src="assets/faculty2.jpg" alt="Mr. Arjun Singh" class="faculty-photo" />
          <div class="faculty-info">
            <h3>Mr. Arjun Singh</h3>
            <p>Mathematics Teacher - Expert in advanced problem solving and Olympiad training.</p>
          </div>
        </li>
        <li class="faculty-member">
          <img src="assets/faculty3.jpg" alt="Mrs. Neha Verma" class="faculty-photo" />
          <div class="faculty-info">
            <h3>Mrs. Neha Verma</h3>
            <p>English Literature - Creative curriculum developer and drama club advisor.</p>
          </div>
        </li>
      </ul>
    </section>

    <section class="section" id="events" tabindex="-1" aria-labelledby="events-heading">
      <h2 id="events-heading">Events & News</h2>
      <ul class="events-list" aria-live="polite">
        <li class="event-item">
          <div class="event-info">
            <h3>Annual Sports Day - August 15, 2025</h3>
            <p>Join us for a day full of sportsmanship and fun activities for all students.</p>
          </div>
        </li>
        <li class="event-item">
          <div class="event-info">
            <h3>Science Exhibition - September 10, 2025</h3>
            <p>A platform for young innovators to showcase their projects and experiments.</p>
          </div>
        </li>
        <li class="event-item">
          <div class="event-info">
            <h3>Parent-Teacher Meeting - October 5, 2025</h3>
            <p>Discuss your child's progress and participate in school development feedback sessions.</p>
          </div>
        </li>
      </ul>
    </section>

    <section class="section" id="gallery" tabindex="-1" aria-labelledby="gallery-heading">
      <h2 id="gallery-heading">Gallery</h2>
      <div class="gallery" role="list" aria-label="School photo gallery">
        <a href="#" data-img="assets/gallery7.jpg" tabindex="0" role="listitem" class="gallery-link">
          <img src="assets/gallery7.jpg" alt="Science experiments in the school lab" />
        </a>
        <a href="#" data-img="assets/gallery8.jpg" tabindex="0" role="listitem" class="gallery-link">
          <img src="assets/gallery8.jpg" alt="School activity or event" />
        </a>
        <a href="#" data-img="assets/gallery9.jpg" tabindex="0" role="listitem" class="gallery-link">
          <img src="assets/gallery9.jpg" alt="School activity or event" />
        </a>
        <a href="#" data-img="assets/gallery10.jpg" tabindex="0" role="listitem" class="gallery-link">
          <img src="assets/gallery10.jpg" alt="School activity or event" />
        </a>
        <a href="#" data-img="assets/gallery11.jpg" tabindex="0" role="listitem" class="gallery-link">
          <img src="assets/gallery11.jpg" alt="School activity or event" />
        </a>
        <a href="#" data-img="assets/gallery12.jpg" tabindex="0" role="listitem" class="gallery-link">
          <img src="assets/gallery12.jpg" alt="School activity or event" />
        </a>
        <a href="#" data-img="assets/gallery13.jpg" tabindex="0" role="listitem" class="gallery-link">
          <img src="assets/gallery13.jpg" alt="School activity or event" />
        </a>
      </div>
      <!-- Modal for image viewing -->
      <div class="gallery-modal" aria-modal="true" role="dialog" tabindex="-1">
        <span class="close-modal" tabindex="0" aria-label="Close image modal">&times;</span>
        <span class="modal-prev" aria-label="Previous image">&#10094;</span>
        <span class="modal-next" aria-label="Next image">&#10095;</span>
        <div class="modal-content">
          <img src="" alt="Gallery image enlarged">
        </div>
      </div>
    </section>

    <section class="section" id="testimonials" tabindex="-1" aria-labelledby="testimonials-heading">
      <h2 id="testimonials-heading">Testimonials</h2>
      <ul class="testimonial-list" aria-live="polite">
        <li class="testimonial-item">
          <div class="testimonial-info">
            <h3>Ravi Kumar, Parent</h3>
            <p>
              "Vikas Public School has transformed my child's life with excellent academics and a nurturing environment."
            </p>
          </div>
        </li>
        <li class="testimonial-item">
          <div class="testimonial-info">
            <h3>Meera Singh, Student</h3>
            <p>
              "The teachers here are supportive and the activities are fun and enriching. I love being part of the school."
            </p>
          </div>
        </li>
        <li class="testimonial-item">
          <div class="testimonial-info">
            <h3>Anita Joshi, Parent</h3>
            <p>
              "Strong focus on all-round development helped my daughter flourish in academics and sports."
            </p>
          </div>
        </li>
      </ul>
    </section>

    <section class="section" id="faq" tabindex="-1" aria-labelledby="faq-heading">
      <h2 id="faq-heading">Frequently Asked Questions</h2>
      <ul class="faq-list" role="list">
        <li class="faq-item">
          <button class="faq-question" aria-expanded="false" aria-controls="faq1" id="faq1-btn">
            What is the admission process?
          </button>
          <div class="faq-answer" id="faq1" role="region" aria-labelledby="faq1-btn">
            We have an application followed by an entrance test and interview. Detailed steps are available in the Admissions section.
          </div>
        </li>
        <li class="faq-item">
          <button class="faq-question" aria-expanded="false" aria-controls="faq2" id="faq2-btn">
            Do you offer transportation facilities?
          </button>
          <div class="faq-answer" id="faq2" role="region" aria-labelledby="faq2-btn">
            Yes, we provide safe and reliable transport services covering major areas of Bengaluru.
          </div>
        </li>
        <li class="faq-item">
          <button class="faq-question" aria-expanded="false" aria-controls="faq3" id="faq3-btn">
            What co-curricular activities are available?
          </button>
          <div class="faq-answer" id="faq3" role="region" aria-labelledby="faq3-btn">
            Students can participate in sports, music, dance, arts, debate, coding clubs, and more.
          </div>
        </li>
      </ul>
    </section>

    <section class="section" id="admissions" tabindex="-1" aria-labelledby="admissions-heading">
      <h2 id="admissions-heading">Admissions</h2>
      <p>
        Admissions open for academic year 2025-26. Start your admission process by downloading our admission form below:
      </p>
      <div class="buttons" style="margin-top: 1.5rem;">
        <a href="assets/admission-form.html" download="VPS-Admission-Form.html" class="btn-modern primary">
          <i class="fas fa-download"></i> Download Admission Form
        </a>
      </div>
      <div style="margin-top: 2rem;">
        <h3>Admission Process</h3>
        <ul>
          <li>Download and fill the admission form completely</li>
          <li>Attach all required documents as mentioned in the form</li>
          <li>Submit the completed form along with documents at the school office</li>
          <li>Admission test/interview will be scheduled for eligible candidates</li>
          <li>Final admission will be confirmed based on test/interview results</li>
        </ul>
      </div>
      <div style="margin-top: 2rem;">
        <h3>Required Documents</h3>
        <ul>
          <li>Birth Certificate</li>
          <li>Transfer Certificate from previous school (if applicable)</li>
          <li>Report Card of previous class</li>
          <li>Passport size photographs (recent)</li>
          <li>Address Proof</li>
          <li>Aadhar Card copy of student and parents</li>
          <li>Category Certificate (if applicable)</li>
        </ul>
      </div>
      <p><strong>Eligibility:</strong> Nursery to Class XII</p>
      <p>
        <strong>Process:</strong> Application &rarr; Entrance Test &rarr; Interview &rarr; Admission
        Confirmation
      </p>
      <p>
        <strong>Required Documents:</strong> Birth Certificate, Previous Year‚Äôs Marksheet,
        Passport-size Photographs, Address Proof.
      </p>
      <div class="cta-wrapper">
        <a href="assets/admission_form.pdf" class="cta-button" download>Download Admission Form</a>
      </div>
    </section>

    <section class="section" id="contact" tabindex="-1" aria-labelledby="contact-heading">
      <h2 id="contact-heading">Contact Us</h2>
      <address>
        <p><strong>Address:</strong> Jaunpur, UP India 222146</p>
        <p><strong>Email:</strong> <a href="mailto:info@vikasschool.edu.in">info@vikasschool.edu.in</a></p>
        <p><strong>Phone:</strong> +91-98765 43210</p>
        <p><strong>Office Hours:</strong> 9 AM ‚Äì 4 PM, Monday to Saturday</p>
      </address>
      <form
        action="#"
        method="post"
        aria-label="Contact form"
        onsubmit="return handleSubmit(event)"
        novalidate
      >
        <input
          type="text"
          name="name"
          id="name"
          placeholder="Your Name"
          required
          aria-required="true"
          aria-describedby="name-error"
        />
        <span id="name-error" style="color:#d32f2f; font-size:0.85rem; display:none;"
          >Please enter your name.</span
        >

        <input
          type="email"
          name="email"
          id="email"
          placeholder="Your Email"
          required
          aria-required="true"
          aria-describedby="email-error"
        />
        <span id="email-error" style="color:#d32f2f; font-size:0.85rem; display:none;"
          >Please enter a valid email.</span
        >

        <textarea
          name="message"
          id="message"
          rows="4"
          placeholder="Your Message"
          aria-describedby="message-help"
        ></textarea>
        <small id="message-help" style="color:#666;">Optional</small>

        <button type="submit">Send Message</button>
      </form>
    </section>
  </main>

  <footer>
    <div class="footer-container">
      <div class="social-icons" aria-label="Social media links">
        <a href="https://facebook.com" target="_blank" rel="noopener" aria-label="Facebook" class="facebook" tabindex="0">
          <i class="fab fa-facebook-f"></i>
        </a>
        <a href="https://twitter.com" target="_blank" rel="noopener" aria-label="Twitter" class="twitter" tabindex="0">
          <i class="fab fa-twitter"></i>
        </a>
        <a href="https://instagram.com" target="_blank" rel="noopener" aria-label="Instagram" class="instagram" tabindex="0">
          <i class="fab fa-instagram"></i>
        </a>
        <a href="https://linkedin.com" target="_blank" rel="noopener" aria-label="LinkedIn" class="linkedin" tabindex="0">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </div>
      <div class="quick-links" aria-label="Quick links">
        <a href="#about" tabindex="0">About</a> |
        <a href="#academics" tabindex="0">Academics</a> |
        <a href="#admissions" tabindex="0">Admissions</a> |
        <a href="#contact" tabindex="0">Contact</a>
      </div>
    </div>
    <div style="margin-top:0.8rem;">&copy; 2025 Vikas Public School, Jaunpur. All Rights Reserved.</div>
  </footer>

  <script src="js/main.js"></script>
  
  <!-- Firebase Configuration - Free Tier Optimized -->
  <script>
    // Wait for DOM to be fully loaded before running Firebase code
    document.addEventListener('DOMContentLoaded', function() {
      // Firebase configuration for free tier
      const firebaseConfig = {
        apiKey: "AIzaSyDZH0ZcGAtrILqdRdI5dIhZCUA0eAJzRpE",
        authDomain: "vpschool-918d6.firebaseapp.com",
        projectId: "vpschool-918d6",
        storageBucket: "vpschool-918d6.firebasestorage.app",
        messagingSenderId: "290237090155",
        appId: "1:290237090155:web:90356cb12d25d5a0a8a42e",
        measurementId: "G-02JK84S8NH"
      };
      
      // Initialize Firebase for main website
      let db;
      if (typeof firebase !== 'undefined') {
        try {
          firebase.initializeApp(firebaseConfig);
          db = firebase.firestore();
          
          // Enable offline persistence for free tier efficiency
          db.enablePersistence({ synchronizeTabs: true })
            .then(() => {
              console.log('Firebase persistence enabled - optimized for free tier!');
            })
            .catch(() => {
              console.log('Persistence not available in this browser');
            });
          
          console.log('Firebase initialized for main website');
          
          // Load dynamic content efficiently
          loadDynamicContent();
        } catch (error) {
          console.log('Firebase not available, using static content');
        }
      }
      
      // Enhanced cache checking function
      async function shouldUseCache(type, cachedTime, now, CACHE_DURATION) {
        // First check if cache is within time limit
        if (!cachedTime || (now - cachedTime >= CACHE_DURATION)) {
          return false;
        }
        
        try {
          // Check if admin has invalidated this cache
          const cacheDoc = await db.collection('cache').doc(type).get();
          if (cacheDoc.exists) {
            const cacheInfo = cacheDoc.data();
            const lastUpdated = cacheInfo.lastUpdated;
            
            // If admin updated content after our cache, invalidate it
            if (lastUpdated > cachedTime) {
              console.log(`Cache invalidated for ${type} - admin updated content`);
              return false;
            }
          }
          
          return true;
        } catch (error) {
          console.log(`Error checking cache invalidation for ${type}, using time-based cache:`, error);
          return (now - cachedTime < CACHE_DURATION);
        }
      }

      // Free tier optimized data loading with auto-invalidation
      async function loadDynamicContent() {
        try {
          const now = Date.now();
          const CACHE_DURATION = 24 * 60 * 60 * 1000; // 24 hours
          
          // Load faculty data with smart caching
          const facultyCache = localStorage.getItem('facultyData');
          const facultyCacheTime = parseInt(localStorage.getItem('facultyCacheTime'));
          
          if (facultyCache && await shouldUseCache('faculty', facultyCacheTime, now, CACHE_DURATION)) {
            // Use cached data to minimize reads
            console.log('Using cached faculty data');
            updateFacultySection(JSON.parse(facultyCache));
          } else {
            // Fetch fresh data only when needed
            console.log('Fetching fresh faculty data');
            const facultySnapshot = await db.collection('faculty').get();
            const facultyData = facultySnapshot.docs.map(doc => ({id: doc.id, ...doc.data()}));
            
            // Cache the data
            localStorage.setItem('facultyData', JSON.stringify(facultyData));
            localStorage.setItem('facultyCacheTime', now.toString());
            
            console.log('Faculty data loaded:', facultyData); // Debug log
            updateFacultySection(facultyData);
          }
          
          // Load testimonials with smart caching
          const testimonialsCache = localStorage.getItem('testimonialsData');
          const testimonialsCacheTime = parseInt(localStorage.getItem('testimonialsCacheTime'));
          
          if (testimonialsCache && await shouldUseCache('testimonials', testimonialsCacheTime, now, CACHE_DURATION)) {
            console.log('Using cached testimonials data');
            updateTestimonialsSection(JSON.parse(testimonialsCache));
          } else {
            console.log('Fetching fresh testimonials data');
            const testimonialsSnapshot = await db.collection('testimonials').get();
            const testimonialsData = testimonialsSnapshot.docs.map(doc => ({id: doc.id, ...doc.data()}));
            
            localStorage.setItem('testimonialsData', JSON.stringify(testimonialsData));
            localStorage.setItem('testimonialsCacheTime', now.toString());
            
            updateTestimonialsSection(testimonialsData);
          }
          
          // Load gallery data with smart caching
          const galleryCache = localStorage.getItem('galleryData');
          const galleryCacheTime = parseInt(localStorage.getItem('galleryCacheTime'));
          
          if (galleryCache && await shouldUseCache('gallery', galleryCacheTime, now, CACHE_DURATION)) {
            console.log('Using cached gallery data');
            updateGallerySection(JSON.parse(galleryCache));
          } else {
            console.log('Fetching fresh gallery data');
            const gallerySnapshot = await db.collection('gallery').get();
            const galleryData = gallerySnapshot.docs.map(doc => ({id: doc.id, ...doc.data()}));
            
            localStorage.setItem('galleryData', JSON.stringify(galleryData));
            localStorage.setItem('galleryCacheTime', now.toString());
            
            updateGallerySection(galleryData);
          }
          
          // Load events data with smart caching
          const eventsCache = localStorage.getItem('eventsData');
          const eventsCacheTime = parseInt(localStorage.getItem('eventsCacheTime'));
          
          if (eventsCache && await shouldUseCache('events', eventsCacheTime, now, CACHE_DURATION)) {
            console.log('Using cached events data');
            updateEventsSection(JSON.parse(eventsCache));
          } else {
            console.log('Fetching fresh events data');
            const eventsSnapshot = await db.collection('events').get();
            const eventsData = eventsSnapshot.docs.map(doc => ({id: doc.id, ...doc.data()}));
            
            localStorage.setItem('eventsData', JSON.stringify(eventsData));
            localStorage.setItem('eventsCacheTime', now.toString());
            
            updateEventsSection(eventsData);
          }
          
          // Load hero section data
          await loadSettingsData('hero', updateHeroSection);
          
          // Load about section data
          await loadSettingsData('about', updateAboutSection);
          
          // Load academics section data
          await loadSettingsData('academics', updateAcademicsSection);
          
          // Load logo data
          await loadSettingsData('logo', updateLogoSection);
          
          // Load school info data
          await loadSettingsData('school-info', updateSchoolInfoSection);
          
          // Load contact data
          await loadSettingsData('contact', updateContactSection);
          
          // Load FAQ data
          const faqCache = localStorage.getItem('faqData');
          const faqCacheTime = parseInt(localStorage.getItem('faqCacheTime'));
          
          if (faqCache && await shouldUseCache('faq', faqCacheTime, now, CACHE_DURATION)) {
            console.log('Using cached FAQ data');
            updateFaqSection(JSON.parse(faqCache));
          } else {
            console.log('Fetching fresh FAQ data');
            const faqSnapshot = await db.collection('faq').get();
            const faqData = faqSnapshot.docs.map(doc => ({id: doc.id, ...doc.data()}));
            
            localStorage.setItem('faqData', JSON.stringify(faqData));
            localStorage.setItem('faqCacheTime', now.toString());
            
            updateFaqSection(faqData);
          }
          
        } catch (error) {
          console.log('Error loading dynamic content, using static fallback:', error);
        }
      }
      
      // Helper function to load settings data (hero, about, school-info, contact)
      async function loadSettingsData(type, updateFunction) {
        try {
          const now = Date.now();
          const CACHE_DURATION = 24 * 60 * 60 * 1000; // 24 hours
          
          const cacheKey = `${type}Data`;
          const cacheTimeKey = `${type}CacheTime`;
          
          const cachedData = localStorage.getItem(cacheKey);
          const cacheTime = parseInt(localStorage.getItem(cacheTimeKey));
          
          if (cachedData && await shouldUseCache(type, cacheTime, now, CACHE_DURATION)) {
            console.log(`Using cached ${type} data`);
            updateFunction(JSON.parse(cachedData));
          } else {
            console.log(`Fetching fresh ${type} data`);
            const docSnapshot = await db.collection('settings').doc(type).get();
            
            if (docSnapshot.exists) {
              const data = docSnapshot.data();
              
              // Cache the data
              localStorage.setItem(cacheKey, JSON.stringify(data));
              localStorage.setItem(cacheTimeKey, now.toString());
              
              updateFunction(data);
            } else {
              console.log(`No ${type} data found in database`);
            }
          }
        } catch (error) {
          console.log(`Error loading ${type} data:`, error);
        }
      }
      
      // Force refresh function for immediate updates
      function forceRefreshContent() {
        console.log('Force refreshing all content...');
        
        // Clear all cache
        localStorage.removeItem('facultyData');
        localStorage.removeItem('facultyCacheTime');
        localStorage.removeItem('testimonialsData');
        localStorage.removeItem('testimonialsCacheTime');
        localStorage.removeItem('galleryData');
        localStorage.removeItem('galleryCacheTime');
        localStorage.removeItem('eventsData');
        localStorage.removeItem('eventsCacheTime');
        localStorage.removeItem('heroData');
        localStorage.removeItem('heroCacheTime');
        localStorage.removeItem('aboutData');
        localStorage.removeItem('aboutCacheTime');
        localStorage.removeItem('academicsData');
        localStorage.removeItem('academicsCacheTime');
        localStorage.removeItem('logoData');
        localStorage.removeItem('logoCacheTime');
        localStorage.removeItem('school-infoData');
        localStorage.removeItem('school-infoCacheTime');
        localStorage.removeItem('contactData');
        localStorage.removeItem('contactCacheTime');
        
        // Reload content
        loadDynamicContent();
        
        // Show user feedback
        showUpdateNotification('Content refreshed successfully!');
      }
      
      // Show update notification
      function showUpdateNotification(message) {
        // Create notification element
        const notification = document.createElement('div');
        notification.style.cssText = `
          position: fixed;
          top: 20px;
          right: 20px;
          background: #10b981;
          color: white;
          padding: 12px 20px;
          border-radius: 8px;
          box-shadow: 0 4px 12px rgba(0,0,0,0.1);
          z-index: 1000;
          font-family: inherit;
          font-size: 14px;
          opacity: 0;
          transform: translateX(100%);
          transition: all 0.3s ease;
        `;
        notification.textContent = message;
        
        document.body.appendChild(notification);
        
        // Show notification
        setTimeout(() => {
          notification.style.opacity = '1';
          notification.style.transform = 'translateX(0)';
        }, 100);
        
        // Hide and remove notification
        setTimeout(() => {
          notification.style.opacity = '0';
          notification.style.transform = 'translateX(100%)';
          setTimeout(() => {
            if (notification.parentNode) {
              notification.parentNode.removeChild(notification);
            }
          }, 300);
        }, 3000);
      }
      
      // Add keyboard shortcut for force refresh (Ctrl+Shift+R)
      document.addEventListener('keydown', function(e) {
        if (e.ctrlKey && e.shiftKey && e.key === 'R') {
          e.preventDefault();
          forceRefreshContent();
        }
      });
      
      function updateFacultySection(facultyData) {
        const facultyList = document.querySelector('.faculty-list');
        if (facultyList && facultyData.length > 0) {
          facultyList.innerHTML = facultyData.map(faculty => {
            // Handle both regular URLs and base64 data URLs
            const photoSrc = faculty.photo || 'assets/default-faculty.svg'; // fallback image
            const safeName = (faculty.name || 'Faculty Member').replace(/"/g, '&quot;');
            const safeRole = (faculty.role || 'Staff').replace(/"/g, '&quot;');
            const safeDescription = (faculty.description || '').replace(/"/g, '&quot;');
            
            return `
            <li class="faculty-member">
              <img src="${photoSrc}" alt="${safeName}" class="faculty-photo" 
                   onerror="this.src='assets/default-faculty.svg'; console.log('Faculty image failed to load, using fallback');" />
              <div class="faculty-info">
                <h3>${safeName}</h3>
                <p>${safeRole}${safeDescription ? ' - ' + safeDescription : ''}</p>
              </div>
            </li>
          `;
          }).join('');
        }
      }
      
      function updateTestimonialsSection(testimonialsData) {
        const testimonialsList = document.querySelector('.testimonial-list');
        if (testimonialsList && testimonialsData.length > 0) {
          testimonialsList.innerHTML = testimonialsData.map(testimonial => `
            <li class="testimonial-item">
              <div class="testimonial-info">
                <h3>${testimonial.name}, ${testimonial.role}</h3>
                <p>"${testimonial.text}"</p>
              </div>
            </li>
          `).join('');
        }
      }
      
      function updateGallerySection(galleryData) {
        const gallery = document.querySelector('.gallery');
        if (gallery && galleryData.length > 0) {
          gallery.innerHTML = galleryData.map(item => {
            // Handle both regular URLs and base64 data URLs
            const imageSrc = item.src || 'assets/gallery7.jpg'; // fallback image
            const safeAlt = (item.alt || 'Gallery image').replace(/"/g, '&quot;');
            
            return `
            <a href="#" data-img="${imageSrc}" tabindex="0" role="listitem" class="gallery-link">
              <img src="${imageSrc}" alt="${safeAlt}" 
                   onerror="this.src='assets/gallery7.jpg'; console.log('Gallery image failed to load, using fallback');" />
            </a>
          `;
          }).join('');
          
          // Re-attach gallery click events after updating content
          setTimeout(() => {
            if (window.attachGalleryEvents) {
              window.attachGalleryEvents();
            }
          }, 100);
        }
      }
      
      // Update functions for admin panel sections
      function updateHeroSection(heroData) {
        const heroElement = document.querySelector('.hero');
        if (heroElement && heroData) {
          // Update hero text
          if (heroData.title || heroData.subtitle) {
            const title = heroData.title || 'Vikas Public School';
            const subtitle = heroData.subtitle || 'Excellence in Education';
            heroElement.textContent = `${title} - ${subtitle}`;
          }
          
          // Update background image if provided
          if (heroData.backgroundImage) {
            heroElement.style.backgroundImage = `url(${heroData.backgroundImage})`;
            heroElement.style.backgroundSize = 'cover';
            heroElement.style.backgroundPosition = 'center';
          }
        }
      }
      
      function updateAboutSection(aboutData) {
        const aboutSection = document.getElementById('about');
        if (aboutSection && aboutData) {
          // Update about intro content
          const aboutIntro = aboutSection.querySelector('.about-intro');
          if (aboutIntro && aboutData.content) {
            aboutIntro.textContent = aboutData.content;
          }
          
          // Update leadership profiles
          if (aboutData.leadership && Array.isArray(aboutData.leadership)) {
            aboutData.leadership.forEach((leader, index) => {
              const profileCard = aboutSection.querySelector(`.${leader.id}-profile`);
              if (profileCard) {
                // Update image
                const img = profileCard.querySelector('img');
                if (img && leader.image) {
                  img.src = leader.image;
                  img.alt = `${leader.name}, ${leader.position}`;
                }
                
                // Update name
                const nameElement = profileCard.querySelector('h4');
                if (nameElement && leader.name) {
                  nameElement.textContent = leader.name;
                }
                
                // Update position
                const positionElement = profileCard.querySelector('.position');
                if (positionElement && leader.position) {
                  positionElement.textContent = leader.position;
                }
                
                // Update description
                const descriptionElement = profileCard.querySelector('.description');
                if (descriptionElement && leader.description) {
                  descriptionElement.textContent = leader.description;
                }
              }
            });
          }
          
          // Update highlights
          if (aboutData.highlights && Array.isArray(aboutData.highlights)) {
            const highlightCards = aboutSection.querySelectorAll('.highlight-card');
            aboutData.highlights.forEach((highlight, index) => {
              if (highlightCards[index]) {
                const card = highlightCards[index];
                
                // Update icon
                const iconElement = card.querySelector('.highlight-icon');
                if (iconElement && highlight.icon) {
                  iconElement.textContent = highlight.icon;
                }
                
                // Update title
                const titleElement = card.querySelector('h4');
                if (titleElement && highlight.title) {
                  titleElement.textContent = highlight.title;
                }
                
                // Update description
                const descElement = card.querySelector('p');
                if (descElement && highlight.description) {
                  descElement.textContent = highlight.description;
                }
              }
            });
          }
        }
      }
      
      function updateSchoolInfoSection(schoolData) {
        // Update header title if school name is provided
        if (schoolData && schoolData.name) {
          const headerTitle = document.querySelector('header h1');
          if (headerTitle) {
            headerTitle.textContent = schoolData.name;
          }
          
          // Update page title
          document.title = schoolData.name;
        }
      }
      
      function updateContactSection(contactData) {
        const contactSection = document.getElementById('contact');
        if (contactSection && contactData) {
          const address = contactSection.querySelector('address');
          if (address) {
            let addressHTML = '';
            
            if (contactData.address) {
              addressHTML += `<p><strong>Address:</strong> ${contactData.address}</p>`;
            }
            if (contactData.email) {
              addressHTML += `<p><strong>Email:</strong> <a href="mailto:${contactData.email}">${contactData.email}</a></p>`;
            }
            if (contactData.phone) {
              addressHTML += `<p><strong>Phone:</strong> ${contactData.phone}</p>`;
            }
            if (contactData.hours) {
              addressHTML += `<p><strong>Office Hours:</strong> ${contactData.hours}</p>`;
            }
            
            // Only update if we have some data
            if (addressHTML) {
              address.innerHTML = addressHTML;
            }
          }
        }
      }
      
      function updateEventsSection(eventsData) {
        const eventsList = document.querySelector('.events-list');
        if (eventsList && eventsData.length > 0) {
          eventsList.innerHTML = eventsData.map(event => {
            const safeTitle = (event.title || 'Event').replace(/"/g, '&quot;');
            const safeDate = (event.date || '').replace(/"/g, '&quot;');
            const safeDescription = (event.description || '').replace(/"/g, '&quot;');
            
            return `
            <li class="event-item">
              <div class="event-info">
                <h3>${safeTitle}${safeDate ? ' - ' + safeDate : ''}</h3>
                <p>${safeDescription}</p>
              </div>
            </li>
          `;
          }).join('');
        }
      }
      
      function updateFaqSection(faqData) {
        const faqList = document.querySelector('.faq-list');
        if (faqList && faqData.length > 0) {
          // Sort FAQ data by order field
          const sortedFaqData = faqData.sort((a, b) => (a.order || 0) - (b.order || 0));
          
          faqList.innerHTML = sortedFaqData.map((faq, index) => {
            const safeQuestion = (faq.question || '').replace(/"/g, '&quot;');
            const safeAnswer = (faq.answer || '').replace(/"/g, '&quot;');
            const faqId = `faq${index + 1}`;
            const btnId = `${faqId}-btn`;
            
            return `
            <li class="faq-item">
              <button class="faq-question" aria-expanded="false" aria-controls="${faqId}" id="${btnId}">
                ${safeQuestion}
              </button>
              <div class="faq-answer" id="${faqId}" role="region" aria-labelledby="${btnId}">
                ${safeAnswer}
              </div>
            </li>
          `;
          }).join('');
          
          // Reinitialize FAQ event listeners for dynamically loaded content
          initializeFaqEventListeners();
        }
      }
      
      function initializeFaqEventListeners() {
        const faqButtons = document.querySelectorAll(".faq-question");
        faqButtons.forEach((btn) => {
          // Remove existing event listeners to avoid duplicates
          btn.replaceWith(btn.cloneNode(true));
        });
        
        // Re-query after cloning
        const newFaqButtons = document.querySelectorAll(".faq-question");
        newFaqButtons.forEach((btn) => {
          btn.addEventListener("click", () => {
            const expanded = btn.getAttribute("aria-expanded") === "true";
            // Collapse all others
            newFaqButtons.forEach((otherBtn) => {
              if (otherBtn !== btn) {
                otherBtn.setAttribute("aria-expanded", "false");
                otherBtn.parentElement.classList.remove("open");
              }
            });
            // Toggle current
            btn.setAttribute("aria-expanded", String(!expanded));
            btn.parentElement.classList.toggle("open", !expanded);
          });
        });
      }
      
      function updateAcademicsSection(academicsData) {
        const academicsSection = document.getElementById('academics');
        if (academicsSection && academicsData) {
          // Update description
          const descriptionP = academicsSection.querySelector('p');
          if (descriptionP && academicsData.description) {
            descriptionP.textContent = academicsData.description;
          }
          
          // Update the list items
          const list = academicsSection.querySelector('ul');
          if (list) {
            list.innerHTML = `
              <li><strong>Curriculum:</strong> ${academicsData.curriculum || 'CBSE syllabus from Nursery to Class XII.'}</li>
              <li><strong>Special Programs:</strong> ${academicsData.programs || 'STEM initiatives, Coding clubs, Language enrichment.'}</li>
              <li><strong>Assessment:</strong> ${academicsData.assessment || 'Continuous Evaluation, Project Based Learning, Olympiads preparation.'}</li>
              <li><strong>Extra-Curricular:</strong> ${academicsData.extracurricular || 'Art, Music, Dance, Debate, and Sports to nurture talents.'}</li>
            `;
          }
        }
      }
      
      function updateLogoSection(logoData) {
        if (logoData) {
          // Update logo image
          const logoImg = document.querySelector('.logo-img');
          if (logoImg && logoData.logoUrl) {
            logoImg.src = logoData.logoUrl;
            logoImg.alt = `${logoData.schoolName || 'School'} Logo`;
          }
          
          // Update school name
          const schoolName = document.querySelector('.school-name');
          if (schoolName && logoData.schoolName) {
            schoolName.textContent = logoData.schoolName;
          }
          
          // Update tagline
          const tagline = document.querySelector('.school-tagline');
          if (tagline && logoData.tagline) {
            tagline.textContent = logoData.tagline;
          }
        }
      }
      
      // Helper function to clear cache for testing (call from browser console)
      window.clearDynamicContentCache = function() {
        localStorage.removeItem('facultyData');
        localStorage.removeItem('facultyCacheTime');
        localStorage.removeItem('testimonialsData');
        localStorage.removeItem('testimonialsCacheTime');
        localStorage.removeItem('galleryData');
        localStorage.removeItem('galleryCacheTime');
        localStorage.removeItem('eventsData');
        localStorage.removeItem('eventsCacheTime');
        localStorage.removeItem('heroData');
        localStorage.removeItem('heroCacheTime');
        localStorage.removeItem('aboutData');
        localStorage.removeItem('aboutCacheTime');
        localStorage.removeItem('academicsData');
        localStorage.removeItem('academicsCacheTime');
        localStorage.removeItem('logoData');
        localStorage.removeItem('logoCacheTime');
        localStorage.removeItem('school-infoData');
        localStorage.removeItem('school-infoCacheTime');
        localStorage.removeItem('contactData');
        localStorage.removeItem('contactCacheTime');
        localStorage.removeItem('faqData');
        localStorage.removeItem('faqCacheTime');
        console.log('All cache cleared! Reload the page to see fresh data.');
      };
    });
  </script>

  <!-- Floating Refresh Button -->
  <button 
    id="refresh-fab" 
    class="refresh-fab"
    onclick="forceRefreshContent()" 
    title="Refresh content (Ctrl+Shift+R)"
  >
    üîÑ
  </button>

  <!-- Back to Top Button -->
  <button 
    id="back-to-top" 
    class="back-to-top"
    onclick="scrollToTop()" 
    title="Back to top"
  >
    ‚¨ÜÔ∏è
  </button>

</body>
</html>
